<section class="content">
  <div class="content-block">
    <div class="block-header">
      <!-- breadcrumb -->
      <app-breadcrumb [title]="pageTitle" [items]="breadcrumsMiddleList"
        [active_item]="langText.DETAILS"></app-breadcrumb>
    </div>
    <!-- <div class="row">
      <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-xs-12">
        <div class="card l-bg-{{this.getBackgroundColorFromNature()}} pt-1 pb-1">
          <div class="body">
            <mat-card-content class="d-flex align-items-center text-white">
              <mat-icon>error</mat-icon>
              <mat-label class="m-l-10">{{this.getNatureInGateAlert()}}</mat-label>
            </mat-card-content>
          </div>
        </div>
      </div>
    </div> -->
    <div class="row">
      <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-xs-12">
        <div class="card p-0 tlx-card">
          <mat-accordion>
            <mat-expansion-panel [expanded]="true" [disabled]="true" hideToggle>
              <mat-expansion-panel-header class="ps-0">
                <mat-panel-title>
                  <div class="d-flex justify-content-between align-items-center w-100">
                    <div class="header">
                      <h2>
                        {{translatedLangText.TANK_SUMMARY_DETAILS}}
                      </h2>
                    </div>
                  </div>
                </mat-panel-title>
              </mat-expansion-panel-header>
              <div class="body p-l-0 p-r-0">
                @if (igDS.loading$ | async) {
                <div class="tbl-spinner">
                  <mat-progress-spinner color="primary" [diameter]="40" mode="indeterminate">
                  </mat-progress-spinner>
                </div>
                }
                @if (!(igDS.loading$ | async)) {
                <mat-card-content>
                  <div class="position-relative">
                    @if(allowPerformAction()) {
                    <div class="relative-menu">
                      @if (!(cvDS.loading$ | async) && (canOverwriteLastCargo() || canOverwriteCleanStatus() ||
                      canOverwriteTankSummaryDetails() || canRenumberTank() || canReownership())) {
                      <button mat-mini-fab color="primary" [matMenuTriggerFor]="menu"
                        [disabled]="(pdDS.actionLoading$ | async)" class="me-2">
                        <mat-icon>edit</mat-icon>
                      </button>
                      <mat-menu #menu="matMenu">
                        @if (canOverwriteTankSummaryDetails()) {
                        <button mat-menu-item (click)="overwriteTankSummaryDialog($event)">
                          {{translatedLangText.TANK_SUMMARY_DETAILS}}</button>
                        }
                        @if (canRenumberTank()) {
                        <button mat-menu-item
                          (click)="renumberTankDialog($event)">{{translatedLangText.RENUMBER}}</button>
                        }
                        @if (canReownership()) {
                        <button mat-menu-item
                          (click)="reownerTankDialog($event)">{{translatedLangText.REOWNERSHIP}}</button>
                        }
                        @if (canChangeCustomer()) {
                        <button mat-menu-item (click)="changeCustomerTankDialog($event)">{{translatedLangText.UPDATE}}
                          {{translatedLangText.CUSTOMER}}</button>
                        }
                        @if (canOverwriteLastCargo()) {
                        <button mat-menu-item
                          (click)="overwriteLastCargoDialog($event)">{{translatedLangText.LAST_CARGO}}</button>
                        }
                        @if (canOverwriteCleanStatus()) {
                        <button mat-menu-item
                          (click)="overwriteCleanStatusDialog($event)">{{translatedLangText.OVERWRITE_CONDITION}}</button>
                        }
                      </mat-menu>
                      }
                    </div>
                    }
                    <div class="row justify-content-center">
                      <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 col-xs-12 m-b-5">
                        <div class="row right-align-display">
                          <div class="col-xl-3 col-lg-2 col-md-2 col-sm-2 col-xs-2 m-b-5">
                            <span class="label-display-info">{{translatedLangText.TANK_NO}}:</span>
                          </div>
                          <div class="col-xl-9 col-lg-10 col-md-10 col-sm-10 col-xs-7 m-b-5">
                            <span class="value-display-info">
                              {{sot?.tank_no}}
                              @if (tiItem?.previous_tank_no) {
                              (<span class="previous-label">{{tiItem?.previous_tank_no}}</span>)
                              }
                            </span>
                          </div>
                        </div>
                        <div class="row right-align-display">
                          <div class="col-xl-3 col-lg-2 col-md-2 col-sm-2 col-xs-2 m-b-5">
                            <span class="label-display-info">{{translatedLangText.CUSTOMER}}:</span>
                          </div>
                          <div class="col-xl-9 col-lg-10 col-md-10 col-sm-10 col-xs-10 m-b-5 ">
                            <span class="value-display-info">
                              {{ccDS.displayName(sot?.storing_order?.customer_company)}}
                            </span>
                          </div>
                        </div>
                        <div class="row right-align-display">
                          <div class="col-xl-3 col-lg-2 col-md-2 col-sm-2 col-xs-2 m-b-5">
                            <span class="label-display-info">{{translatedLangText.OWNER}}:</span>
                          </div>
                          <div class="col-xl-9 col-lg-10 col-md-10 col-sm-10 col-xs-10 m-b-5 ">
                            <span class="value-display-info">
                              {{ccDS.displayName(sot?.customer_company)}}
                              @if (tiItem?.previous_customer_company) {
                              (<span class="previous-label">{{tiItem?.previous_customer_company?.code}}</span>)
                              }
                            </span>
                          </div>
                        </div>
                        <div class="row right-align-display">
                          <div class="col-xl-3 col-lg-3 col-md-3 col-sm-3 col-xs-3 m-b-5">
                            <span class="label-display-info">{{translatedLangText.CURRENT_STATUS}}:</span>
                          </div>
                          <div class="col-xl-9 col-lg-9 col-md-9 col-sm-9 col-xs-9 m-b-5 ">
                            <span class="value-display-info">
                              {{getTankStatusDescription(sot?.tank_status_cv)}}
                            </span>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-4-5 col-lg-4-5 col-md-12 col-sm-12 col-xs-12 m-b-5">
                        <div class="row right-align-display">
                          <div class="col-xl-3 col-lg-3 col-md-3 col-sm-3 col-xs-3 m-b-5">
                            <span class="label-display-info">{{translatedLangText.EIR_NO}}:</span>
                          </div>
                          <div class="col-xl-9 col-lg-9 col-md-9 col-sm-9 col-xs-9 m-b-5 ">
                            <span class="value-display-info">
                              {{igDS.getInGateItem(sot?.in_gate)?.eir_no ||"-"}}
                            </span>
                          </div>
                        </div>
                        <div class="row right-align-display">
                          <div class="col-xl-3 col-lg-3 col-md-3 col-sm-3 col-xs-3 m-b-5">
                            <span class="label-display-info">{{translatedLangText.EIR_DATE}}:</span>
                          </div>
                          <div class="col-xl-9 col-lg-9 col-md-9 col-sm-9 col-xs-9 m-b-5 ">
                            <span class="value-display-info">
                              {{displayDateTime(igDS.getInGateItem(sot?.in_gate)?.eir_dt)|| "-"}}
                            </span>
                          </div>
                        </div>
                        <div class="row right-align-display">
                          <div class="col-xl-3 col-lg-3 col-md-3 col-sm-3 col-xs-2 m-b-5">
                            <span class="label-display-info">{{translatedLangText.LAST_CARGO}}:</span>
                          </div>
                          <div class="col-xl-9 col-lg-10 col-md-10 col-sm-10 col-xs-10 m-b-5 ">
                            <span class="value-display-info">
                              {{sot?.tariff_cleaning?.cargo}}
                            </span>
                          </div>
                        </div>
                        <div class="row right-align-display">
                          <div class="col-xl-3 col-lg-3 col-md-3 col-sm-3 col-xs-3 m-b-5">
                            <span class="label-display-info">{{translatedLangText.CLEAN_STATUS}}:</span>
                          </div>
                          <div class="col-xl-9 col-lg-9 col-md-9 col-sm-9 col-xs-9 m-b-5 ">
                            <span class="value-display-info">
                              {{getCleanStatusDescription(sot?.clean_status_cv)}}
                            </span>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3-25 col-lg-3-25 col-md-12 col-sm-12 col-xs-12 m-b-5">
                        <div class="row right-align-display">
                          <div class="col-xl-3 col-lg-3 col-md-3 col-sm-3 col-xs-3 m-b-5">
                            <span class="label-display-info">{{translatedLangText.PURPOSE}}:</span>
                          </div>
                          <div class="col-xl-9 col-lg-9 col-md-9 col-sm-9 col-xs-9 m-b-5 ">
                            <span class="value-display-info">
                              {{displayTankPurpose(sot!)}}
                            </span>
                          </div>
                        </div>
                        <div class="row right-align-display">
                          <div class="col-xl-3 col-lg-3 col-md-3 col-sm-3 col-xs-3 m-b-5">
                            <span class="label-display-info">{{translatedLangText.LAST_TEST}}:</span>
                          </div>
                          <div class="col-xl-9 col-lg-9 col-md-9 col-sm-9 col-xs-9 m-b-5 ">
                            <span class="value-display-info">
                              {{last_test_desc || '-'}}
                            </span>
                          </div>
                        </div>
                        <div class="row right-align-display">
                          <div class="col-xl-3 col-lg-3 col-md-3 col-sm-3 col-xs-3 m-b-5">
                            <span class="label-display-info">{{translatedLangText.NEXT_TEST}}:</span>
                          </div>
                          <div class="col-xl-9 col-lg-9 col-md-9 col-sm-9 col-xs-9 m-b-5 ">
                            <span class="value-display-info">
                              {{next_test_desc || '-'}}
                            </span>
                          </div>
                        </div>
                        <div class="row right-align-display">
                          <div class="col-xl-3 col-lg-3 col-md-3 col-sm-3 col-xs-3 m-b-5">
                            <span class="label-display-info">{{translatedLangText.YARD}}:</span>
                          </div>
                          <div class="col-xl-9 col-lg-9 col-md-9 col-sm-9 col-xs-9 m-b-5 ">
                            <span class="value-display-info">
                              {{getYardDescription(getLastLocation())}}
                            </span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </mat-card-content>
                }
              </div>
            </mat-expansion-panel>
          </mat-accordion>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-xs-12">
        <div class="card bg-opacity-0 border-0 p-0">
          <div class="row">
            <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-xs-12">
              <mat-accordion multi>
                <mat-expansion-panel class="alternate-panel" [expanded]="verifySection(accordionSections.tank_details)">
                  <mat-expansion-panel-header class="ps-0 tank-header"
                    (click)="setSection(accordionSections.tank_details)">
                    <mat-panel-title>
                      <div class="d-flex justify-content-between align-items-center w-100" color="primary">
                        <div class="header">
                          <h2>
                            {{translatedLangText.TANK_DETAILS}}
                          </h2>
                        </div>
                        <button mat-icon-button (click)="expandAll($event, accordionSections.tank_details)"
                          [matTooltip]="!isAllExpand() ? translatedLangText.EXPAND_ALL : translatedLangText.COLLAPSE_ALL">
                          <mat-icon>unfold_more</mat-icon>
                        </button>
                      </div>
                    </mat-panel-title>
                  </mat-expansion-panel-header>
                  <div class="body p-l-0 p-r-0">
                    @if (igDS.loading$ | async) {
                    <div class="tbl-spinner">
                      <mat-progress-spinner color="primary" [diameter]="40" mode="indeterminate">
                      </mat-progress-spinner>
                    </div>
                    }
                    @if (!(igDS.loading$ | async)) {
                    <mat-card-content>
                      <div class="position-relative">
                        @if(allowPerformAction()) {
                        <div class="relative-menu">
                          @if (!(cvDS.loading$ | async) && (canOverwriteTankDetails())) {
                          <button mat-mini-fab color="primary" [matMenuTriggerFor]="menu"
                            [disabled]="(pdDS.actionLoading$ | async)" class="me-2">
                            <mat-icon>edit</mat-icon>
                          </button>
                          <mat-menu #menu="matMenu">
                            @if (canOverwriteTankDetails()) {
                            <button mat-menu-item (click)="overwriteTankDetailsDialog($event)">
                              {{translatedLangText.TANK_DETAILS}}</button>
                            }
                          </mat-menu>
                          }
                        </div>
                        }
                        <div class="row justify-content-center">
                          <div class="col-xl-4 col-lg-4 col-md-4 col-sm-4 col-xs-12 m-b-5">
                            <div class="row right-align-display">
                              <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                <span class="label-display-info">{{translatedLangText.UNIT_TYPE}}:</span>
                              </div>
                              <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                <span class="value-display-info">
                                  {{sot?.tank?.unit_type}}
                                </span>
                              </div>
                            </div>
                            <div class="row right-align-display">
                              <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                <span class="label-display-info">{{translatedLangText.MANUFACTURER_DOM}}:</span>
                              </div>
                              <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                <span class="value-display-info">
                                  {{igs?.manufacturer_cv || "-"}} - {{displayDate(igs?.dom_dt)}}
                                </span>
                              </div>
                            </div>
                            <div class="row right-align-display">
                              <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                <span class="label-display-info">{{translatedLangText.CLADDING}}:</span>
                              </div>
                              <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                <span class="value-display-info">
                                  {{getCladdingDescription(igs?.cladding_cv) || "-"}}
                                </span>
                              </div>
                            </div>
                            <div class="row right-align-display">
                              <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                <span class="label-display-info">{{translatedLangText.NOTES}}:</span>
                              </div>
                              <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5 d-flex align-items-center">
                                <div class="d-flex align-items-center">
                                  <span class="value-display-info me-2">
                                    {{sot?.tank_note || "-"}}
                                  </span>
                                  <mat-icon color="primary" class="cursor-pointer"
                                    (click)="editTankNotes($event)">mode_edit</mat-icon>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="col-xl-4 col-lg-4 col-md-4 col-sm-4 col-xs-4 m-b-5">
                            <div class="row right-align-display">
                              <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                <span class="label-display-info">{{translatedLangText.CAPACITY}}:</span>
                              </div>
                              <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                <span class="value-display-info">
                                  {{igs?.capacity || "-"}} {{translatedLangText.LITERS}}
                                </span>
                              </div>
                            </div>
                            <div class="row right-align-display">
                              <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                <span class="label-display-info">{{translatedLangText.TARE_WEIGHT}}:</span>
                              </div>
                              <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                <span class="value-display-info">
                                  {{igs?.tare_weight || "-"}} {{translatedLangText.KG}}
                                </span>
                              </div>
                            </div>
                            <div class="row right-align-display">
                              <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                <span class="label-display-info">{{translatedLangText.MAX_GROSS_WEIGHT}}:</span>
                              </div>
                              <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                <span class="value-display-info">
                                  {{getMaxGrossWeightDescription(igs?.max_weight_cv) || "-"}}
                                </span>
                              </div>
                            </div>

                            <div class="row right-align-display">
                              <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                <span class="label-display-info">{{translatedLangText.RELEASE_NOTES}}:</span>
                              </div>
                              <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5 d-flex align-items-center">
                                <div class="d-flex align-items-center">
                                  <span class="value-display-info me-2">{{sot?.release_note || "-"}}</span>
                                  <mat-icon color="primary" class="cursor-pointer"
                                    (click)="editTankNotes($event)">mode_edit</mat-icon>
                                </div>
                              </div>
                            </div>
                          </div>

                          <div class="col-xl-4 col-lg-4 col-md-4 col-sm-4 col-xs-4 m-b-5">
                            <div class="row right-align-display">
                              <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                <span class="label-display-info">{{translatedLangText.COMPARTMENT_TYPE}}:</span>
                              </div>
                              <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                <span class="value-display-info">
                                  {{igs?.tariff_buffer?.buffer_type || "-"}}
                                </span>
                              </div>
                            </div>

                            <div class="row right-align-display">
                              <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                <span class="label-display-info">{{translatedLangText.BOTTOM_DIS_TYPE}}:</span>
                              </div>
                              <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                <span class="value-display-info">
                                  {{getDisCompDescription(igs?.btm_dis_comp_cv) || "-"}}
                                </span>
                              </div>
                            </div>

                            <div class="row right-align-display">
                              <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                <span class="label-display-info">{{translatedLangText.WALKWAY}}:</span>
                              </div>
                              <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                <span class="value-display-info">
                                  {{getWalkwayDescription(igs?.walkway_cv) || "-"}}
                                </span>
                              </div>
                            </div>

                          </div>
                        </div>
                      </div>
                    </mat-card-content>
                    }
                  </div>
                </mat-expansion-panel>
                <mat-expansion-panel class="" [expanded]="verifySection(accordionSections.gate_details)">
                  <mat-expansion-panel-header class="ps-0 tank-header"
                    (click)="setSection(accordionSections.gate_details)">
                    <mat-panel-title>
                      <div class="d-flex justify-content-between align-items-center w-100">
                        <div class="header">
                          <h2>
                            {{translatedLangText.GATE_DETAILS}}
                          </h2>
                        </div>
                        <button mat-icon-button (click)="expandAll($event, accordionSections.gate_details)"
                          [matTooltip]="!isAllExpand() ? translatedLangText.EXPAND_ALL : translatedLangText.COLLAPSE_ALL">
                          <mat-icon>unfold_more</mat-icon>
                        </button>
                      </div>
                    </mat-panel-title>
                  </mat-expansion-panel-header>
                  <div class="body p-l-0 p-r-0">
                    @if ((igDS.loading$ | async) || (ogDS.loading$ | async)) {
                    <div class="tbl-spinner">
                      <mat-progress-spinner color="primary" [diameter]="40" mode="indeterminate">
                      </mat-progress-spinner>
                    </div>
                    }
                    @if (!(igDS.loading$ | async) && !(ogDS.loading$ | async)) {
                    <mat-card-content>
                      <div class="position-relative">
                        @if(allowPerformAction()) {
                        <div class="relative-menu">
                          @if (!(cvDS.loading$ | async) && (canOverwriteInGateDetails() ||
                          canOverwriteOutGateDetails())) {
                          <button mat-mini-fab color="primary" [matMenuTriggerFor]="menu"
                            [disabled]="(pdDS.actionLoading$ | async)" class="me-2">
                            <mat-icon>edit</mat-icon>
                          </button>
                          <mat-menu #menu="matMenu">
                            @if (canOverwriteInGateDetails()) {
                            <button mat-menu-item (click)="overwriteGateDetailsDialog($event, ig, 'in')">
                              {{translatedLangText.IN_GATE}}</button>
                            }
                            @if (canOverwriteOutGateDetails()) {
                            <button mat-menu-item (click)="overwriteGateDetailsDialog($event, og, 'out')">
                              {{translatedLangText.OUT_GATE}}</button>
                            }
                          </mat-menu>
                          }
                        </div>
                        }
                        <div class="row justify-content-center">
                          <div class="col-xl-5 col-lg-6 col-md-12 col-sm-12 col-xs-12 m-b-5">
                            <div class="row">
                              <div
                                class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-xs-12 m-b-5 d-flex justify-content-center">
                                <span
                                  class="contact-detail-info font-bold text-decoration-underline cursor-pointer ms-2 me-5 pe-5"
                                  (click)="onDownloadEir()">
                                  {{translatedLangText.IN_GATE}}
                                </span>
                              </div>
                            </div>
                            <div class="row right-align-display">
                              <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                <span class="label-display-info">{{translatedLangText.SO_NO}}:</span>
                              </div>
                              <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                <span class="value-display-info"> {{sot?.storing_order?.so_no || "-"}}
                                </span>
                              </div>
                            </div>
                            <div class="row right-align-display">
                              <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                <span class="label-display-info">{{translatedLangText.JOB_NO}}:</span>
                              </div>
                              <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                <span class="value-display-info"> {{sot?.job_no || "-"}}
                                </span>
                              </div>
                            </div>
                            <div class="row right-align-display">
                              <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                <span class="label-display-info">{{translatedLangText.DATE}}:</span>
                              </div>
                              <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                <span class="value-display-info">{{displayDateTime(ig?.eir_dt) || "-"}}
                                </span>
                              </div>
                            </div>
                            <div class="row right-align-display">
                              <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                <span class="label-display-info">{{translatedLangText.HAULIER}}:</span>
                              </div>
                              <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                <span class="value-display-info">{{ig?.haulier || "-"}}</span>
                              </div>
                            </div>
                            <div class="row right-align-display">
                              <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                <span class="label-display-info">{{translatedLangText.VEHICLE_NO}}:</span>
                              </div>
                              <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                <span class="value-display-info">{{ig?.vehicle_no || "-"}}</span>
                              </div>
                            </div>
                            <div class="row right-align-display">
                              <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                <span class="label-display-info">{{translatedLangText.DRIVER_NAME}}:</span>
                              </div>
                              <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                <span class="value-display-info">{{ig?.driver_name || "-"}}</span>
                              </div>
                            </div>
                            <div class="row right-align-display">
                              <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                <span class="label-display-info">{{translatedLangText.REMARKS}}:</span>
                              </div>
                              <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                <span class="value-display-info">{{ig?.remarks || "-"}}</span>
                              </div>
                            </div>
                          </div>
                          <div class="col-xl-5 col-lg-6 col-md-12 col-sm-12 col-xs-12 m-b-5">
                            <div class="row">
                              <div
                                class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-xs-12 m-b-5 d-flex justify-content-center">
                                <span
                                  class="contact-detail-info font-bold text-decoration-underline  cursor-pointer ms-2 me-5 pe-5"
                                  (click)="onDownloadEir(false)">
                                  {{translatedLangText.OUT_GATE}}
                                </span>
                              </div>
                            </div>
                            <div class="row right-align-display">
                              <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                <span class="label-display-info">{{translatedLangText.RO_NO}}:</span>
                              </div>
                              <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                <span class="value-display-info">
                                  {{sot?.release_order_sot?.[0]?.release_order?.ro_no || "-"}}
                                </span>
                              </div>
                            </div>
                            <div class="row right-align-display">
                              <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                <span class="label-display-info">{{translatedLangText.JOB_NO}}:</span>
                              </div>
                              <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                <span class="value-display-info">{{sot?.release_job_no || "-"}}</span>
                              </div>
                            </div>
                            <div class="row right-align-display">
                              <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                <span class="label-display-info">{{translatedLangText.DATE}}:</span>
                              </div>
                              <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                <span class="value-display-info">{{displayDateTime(og?.eir_dt) || "-"}}</span>
                              </div>
                            </div>
                            <div class="row right-align-display">
                              <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                <span class="label-display-info">{{translatedLangText.HAULIER}}:</span>
                              </div>
                              <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                <span class="value-display-info">{{og?.haulier || "-"}}</span>
                              </div>
                            </div>
                            <div class="row right-align-display">
                              <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                <span class="label-display-info">{{translatedLangText.VEHICLE_NO}}:</span>
                              </div>
                              <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                <span class="value-display-info">{{og?.vehicle_no || "-"}}</span>
                              </div>
                            </div>
                            <div class="row right-align-display">
                              <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                <span class="label-display-info">{{translatedLangText.DRIVER_NAME}}:</span>
                              </div>
                              <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                <span class="value-display-info">{{og?.driver_name || "-"}}</span>
                              </div>
                            </div>
                            <div class="row right-align-display">
                              <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                <span class="label-display-info">{{translatedLangText.REMARKS}}:</span>
                              </div>
                              <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                <span class="value-display-info">{{og?.remarks || "-"}}</span>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </mat-card-content>
                    }
                  </div>
                </mat-expansion-panel>
                <mat-expansion-panel class="alternate-panel"
                  [expanded]="verifySection(accordionSections.purpose_details)">
                  <mat-expansion-panel-header class="ps-0 tank-header"
                    (click)="setSection(accordionSections.purpose_details)">
                    <mat-panel-title>
                      <div class="d-flex justify-content-between align-items-center w-100">
                        <div class="header">
                          <h2>
                            {{translatedLangText.PURPOSE}}
                          </h2>
                        </div>
                        <button mat-icon-button (click)="expandAll($event, accordionSections.purpose_details)"
                          [matTooltip]="!isAllExpand() ? translatedLangText.EXPAND_ALL : translatedLangText.COLLAPSE_ALL">
                          <mat-icon>unfold_more</mat-icon>
                        </button>
                      </div>
                    </mat-panel-title>
                  </mat-expansion-panel-header>
                  <div class="body p-t-0 p-l-0 p-r-0">
                    <mat-card-content>
                      <div class="row">
                        <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-xs-12 m-b-0">
                          <mat-tab-group class="tlx-mdc-tab-group" dynamicHeight>
                            <mat-tab>
                              <ng-template mat-tab-label>
                                <span [ngClass]="'m-r-10 d-flex align-items-center'">
                                  <mat-icon class="m-r-5">storage</mat-icon>{{ translatedLangText.STORAGE }}
                                </span>
                              </ng-template>
                              @if ((pdDS.loading$ | async) || (sotDS.loading$ | async) || (sotDS.actionLoading$ |
                              async)) {
                              <div class="tbl-spinner">
                                <mat-progress-spinner color="primary" [diameter]="40" mode="indeterminate">
                                </mat-progress-spinner>
                              </div>
                              }
                              @if (!(pdDS.loading$ | async) && !(sotDS.loading$ | async) && !(sotDS.actionLoading$ |
                              async)) {
                              @if (sot?.purpose_storage) {
                              <div class="position-relative">
                                <!-- Overwrite storage same as overwrite depot cost -->
                                <!-- @if(allowPerformAction()) {
                                <div class="relative-menu">
                                  @if (!(cvDS.loading$ | async) && (canOverwriteStoragePurpose())) {
                                  <button mat-mini-fab color="primary" [matMenuTriggerFor]="menu"
                                    [disabled]="(pdDS.actionLoading$ | async)" class="me-2">
                                    <mat-icon>edit</mat-icon>
                                  </button>
                                  <mat-menu #menu="matMenu">
                                    @if (canOverwriteStoragePurpose()) {
                                    <button mat-menu-item
                                      (click)="overwritePurposeStorageDialog($event)">{{translatedLangText.OVERWRITE}}
                                      {{translatedLangText.STORAGE}}</button>
                                    }
                                  </mat-menu>
                                  }
                                </div>
                                } -->
                                <div class="row justify-content-center pt-5">
                                  <div class="col-xl-5 col-lg-6 col-md-12 col-sm-12 col-xs-12 m-b-5">
                                    <div class="row right-align-display">
                                      <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                        <span class="label-display-info">{{translatedLangText.BEGIN_DATE}}:</span>
                                      </div>
                                      <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                        <span class="value-display-info">
                                          {{displayDate(pdDS.getStorageBeginDate(sot!,
                                          sot?.billing_sot?.storage_cal_cv!)) || "-"}}
                                        </span>
                                      </div>
                                    </div>
                                    <div class="row right-align-display">
                                      <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                        <span class="label-display-info">{{translatedLangText.STORAGE_DAYS}}:</span>
                                      </div>
                                      <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                        <span class="value-display-info">
                                          {{pdDS.getStorageDays(sot!, pdItem!) || "-"}}
                                        </span>
                                      </div>
                                    </div>
                                    <div class="row right-align-display">
                                      <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                        <span class="label-display-info">{{translatedLangText.AVAILABLE_DATE}}:</span>
                                      </div>
                                      <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                        <span class="value-display-info">
                                          {{getAvailableDate(sot!) || "-"}}
                                        </span>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="col-xl-5 col-lg-6 col-md-12 col-sm-12 col-xs-12 m-b-5">
                                    <div class="row right-align-display">
                                      <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                        <span class="label-display-info">{{translatedLangText.RELEASE_DATE}}:</span>
                                      </div>
                                      <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                        <span class="value-display-info">
                                          {{displayDate(ogDS.getOutGateItem(sot?.out_gate)?.create_dt) || "-"}}
                                        </span>
                                      </div>
                                    </div>
                                    <div class="row right-align-display">
                                      <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                        <span
                                          class="label-display-info">{{translatedLangText.FREE_STORAGE_DAYS}}:</span>
                                      </div>
                                      <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                        <span class="value-display-info">
                                          {{pdItem?.free_storage || "-"}}
                                        </span>
                                      </div>
                                    </div>
                                    <div class="row right-align-display">
                                      <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                        <span
                                          class="label-display-info">{{translatedLangText.STORAGE_CALCULATE_BY}}:</span>
                                      </div>
                                      <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                        <span class="value-display-info">
                                          {{getStorageCalDescription(sot?.billing_sot?.storage_cal_cv) ?? "-"}}
                                        </span>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              }
                              @else {
                              <div class="empty-purpose">
                                <mat-icon class="icon-large">error_outline</mat-icon>
                                <span class="mb-3">{{translatedLangText.NO_STORAGE_PURPOSE}}</span>
                                @if (canAddPurpose('storage')) {
                                <button mat-flat-button color="primary"
                                  (click)="updatePurposeDialog($event, 'storage', 'add')">
                                  <mat-icon>
                                    add
                                  </mat-icon>
                                  {{translatedLangText.ADD_STORAGE_PURPOSE}}
                                </button>
                                }
                              </div>
                              }
                              }
                            </mat-tab>
                            @if(allowPerformAction()){
                            <mat-tab>
                              <ng-template mat-tab-label>
                                <span [ngClass]="'m-r-10 d-flex align-items-center'">
                                  <!-- <i class="fas fa-thermometer-half fa-icon m-r-5"></i>{{ translatedLangText.STEAM }} -->
                                  <mat-icon class="m-r-5">whatshot</mat-icon>{{ translatedLangText.STEAM }}
                                </span>
                              </ng-template>
                              @if ((pdDS.loading$ | async) || (sotDS.loading$ | async) || (sotDS.actionLoading$ |
                              async)) {
                              <div class="tbl-spinner">
                                <mat-progress-spinner color="primary" [diameter]="40" mode="indeterminate">
                                </mat-progress-spinner>
                              </div>
                              }
                              @if (!(pdDS.loading$ | async) && !(sotDS.loading$ | async) && !(sotDS.actionLoading$ |
                              async)) {
                              @if (sot?.purpose_steam) {
                              <div class="position-relative">
                                @if (!isNoPurpose(sot!, 'steaming') && canRemovePurpose('steaming')) {
                                <button color="warn" [matTooltip]="translatedLangText.REMOVE_STEAM_PURPOSE"
                                  (click)="updatePurposeDialog($event, 'steaming', 'remove')"
                                  class="link-button text-danger position-absolute top-0 end-0 p-0">
                                  <mat-icon>cancel</mat-icon>
                                </button>
                                }
                                <div class="row justify-content-center pt-4 pb-3">
                                  <div class="col-xl-5 col-lg-6 col-md-12 col-sm-12 col-xs-12 m-b-5">
                                    <div class="row right-align-display">
                                      <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                        <span class="label-display-info">{{translatedLangText.BEGIN_DATE}}:</span>
                                      </div>
                                      <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                        <span class="value-display-info">
                                          {{displayDateTime(steamDS.getSteamBeginDate(steamItem)) || "-"}}
                                        </span>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="col-xl-5 col-lg-6 col-md-12 col-sm-12 col-xs-12 m-b-5">
                                    <div class="row right-align-display">
                                      <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                        <span class="label-display-info">{{translatedLangText.COMPLETE_DATE}}:</span>
                                      </div>
                                      <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                        <span class="value-display-info">
                                          {{displayDateTime(steamDS.getSteamCompleteDate(steamItem)) || "-"}}
                                        </span>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                                <div class="row">
                                  <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-xs-12 m-b-0">
                                    <div class="responsive_table">
                                      <table mat-table [dataSource]="steamItem" matSort
                                        class="mat-cell advance-tab-table striped-rows hover-highlight dark-header curve-table">
                                        <ng-container matColumnDef="id">
                                          <mat-header-cell *matHeaderCellDef></mat-header-cell>
                                          <mat-cell *matCellDef="let row">{{row.guid}}</mat-cell>
                                        </ng-container>
                                        <ng-container matColumnDef="estimate_no">
                                          <mat-header-cell mat-header-cell *matHeaderCellDef
                                            [ngClass]="'tbl-col-width-per-1_5-xl tbl-col-width-per-1_5-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                            {{translatedLangText.ESTIMATE_NO}}
                                          </mat-header-cell>
                                          <mat-cell mat-cell *matCellDef="let row"
                                            [ngClass]="'tbl-col-width-per-1_5-xl tbl-col-width-per-1_5-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                            <span class="mobile-tab-label">{{translatedLangText.ESTIMATE_NO}}:</span>
                                            <span class="me-1">{{row.estimate_no}}</span>
                                            @if (isAutoApproveSteaming(row)) {
                                            <mat-icon>whatshot</mat-icon>
                                            }
                                            @else {
                                            <mat-icon>build</mat-icon>
                                            }
                                          </mat-cell>
                                        </ng-container>
                                        <ng-container matColumnDef="degree_celsius">
                                          <mat-header-cell mat-header-cell *matHeaderCellDef
                                            [ngClass]="'tbl-col-width-per-0_5-xl tbl-col-width-per-0_5-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                            {{translatedLangText.DEGREE_CELSIUS_SYMBOL}}
                                          </mat-header-cell>
                                          <mat-cell mat-cell *matCellDef="let row"
                                            [ngClass]="'tbl-col-width-per-0_5-xl tbl-col-width-per-0_5-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                            <span
                                              class="mobile-tab-label">{{translatedLangText.DEGREE_CELSIUS_SYMBOL}}:</span>{{steamDS.getSteamHighestTemp(row)}}
                                          </mat-cell>
                                        </ng-container>
                                        <ng-container matColumnDef="estimate_date">
                                          <mat-header-cell mat-header-cell *matHeaderCellDef
                                            [ngClass]="'tbl-col-width-per-1_75-xl tbl-col-width-per-1_75-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                            {{translatedLangText.ESTIMATE_DATE}}
                                          </mat-header-cell>
                                          <mat-cell mat-cell *matCellDef="let row"
                                            [ngClass]="'tbl-col-width-per-1_75-xl tbl-col-width-per-1_75-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                            <span class="mobile-tab-label">{{translatedLangText.ESTIMATE_DATE}}:</span>
                                            <span>{{displayDate(row.create_dt) ?? "-"}}</span>
                                          </mat-cell>
                                        </ng-container>
                                        <ng-container matColumnDef="approve_dt">
                                          <mat-header-cell mat-header-cell *matHeaderCellDef
                                            [ngClass]="'tbl-col-width-per-1_75-xl tbl-col-width-per-1_75-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                            {{translatedLangText.APPROVED_NO_ACTION}}
                                          </mat-header-cell>
                                          <mat-cell mat-cell *matCellDef="let row"
                                            [ngClass]="'tbl-col-width-per-1_75-xl tbl-col-width-per-1_75-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                            <span
                                              class="mobile-tab-label">{{translatedLangText.APPROVED_NO_ACTION}}:</span>
                                            <span>{{displayDate(row.approve_dt) ?? "-"}}</span>
                                          </mat-cell>
                                        </ng-container>
                                        <ng-container matColumnDef="begin_dt">
                                          <mat-header-cell mat-header-cell *matHeaderCellDef
                                            [ngClass]="'tbl-col-width-per-1_25-xl tbl-col-width-per-1_25-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                            {{translatedLangText.BEGIN_DATE}}
                                          </mat-header-cell>
                                          <mat-cell mat-cell *matCellDef="let row"
                                            [ngClass]="'tbl-col-width-per-1_25-xl tbl-col-width-per-1_25-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                            <span class="mobile-tab-label">{{translatedLangText.BEGIN_DATE}}:</span>
                                            <span>{{displayDate(row.approve_dt) ?? "-"}}</span>
                                          </mat-cell>
                                        </ng-container>
                                        <ng-container matColumnDef="complete_dt">
                                          <mat-header-cell mat-header-cell *matHeaderCellDef
                                            [ngClass]="'tbl-col-width-per-1_75-xl tbl-col-width-per-1_75-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                            {{translatedLangText.COMPLETE_DATE}}
                                          </mat-header-cell>
                                          <mat-cell mat-cell *matCellDef="let row"
                                            [ngClass]="'tbl-col-width-per-1_75-xl tbl-col-width-per-1_75-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                            <span class="mobile-tab-label">{{translatedLangText.COMPLETE_DATE}}:</span>
                                            <span>{{displayDate(row.complete_dt) ?? "-"}}</span>
                                          </mat-cell>
                                        </ng-container>
                                        <ng-container matColumnDef="status_cv">
                                          <mat-header-cell mat-header-cell *matHeaderCellDef
                                            [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                            {{translatedLangText.STATUS}}
                                          </mat-header-cell>
                                          <mat-cell mat-cell *matCellDef="let row"
                                            [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                            <span
                                              class="mobile-tab-label">{{translatedLangText.STATUS}}:</span>{{getProcessStatusDescription(row?.status_cv)}}
                                          </mat-cell>
                                        </ng-container>
                                        <ng-container matColumnDef="bill">
                                          <mat-header-cell mat-header-cell *matHeaderCellDef
                                            [ngClass]="'tbl-col-width-per-0_75-xl tbl-col-width-per-0_75-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                            {{translatedLangText.BILL}}
                                          </mat-header-cell>
                                          <mat-cell mat-cell *matCellDef="let row"
                                            [ngClass]="'tbl-col-width-per-0_75-xl tbl-col-width-per-0_75-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                            <span class="mobile-tab-label">{{translatedLangText.BILL}}:</span>
                                            @if (row?.customer_billing_guid) {
                                            <mat-icon
                                              class="material-icons-two-tone col-green font-bold m-l-0">checked</mat-icon>
                                            }
                                            @else {
                                            <mat-icon
                                              class="material-icons-two-tone col-red font-bold m-l-0">close</mat-icon>
                                            }
                                          </mat-cell>
                                        </ng-container>
                                        <ng-container matColumnDef="actions">
                                          <mat-header-cell
                                            [ngClass]="'tbl-col-width-per-0_75-xl tbl-col-width-per-0_75-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'"
                                            *matHeaderCellDef>
                                          </mat-header-cell>
                                          <mat-cell *matCellDef="let row; let i=index;"
                                            [ngClass]="'tbl-col-width-per-0_75-xl tbl-col-width-per-0_75-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm pr-0 justify-content-end'">
                                            @if (canRollbackSteamingCompleted(row) || canOverwriteSteamingApproval(row))
                                            {
                                            <button mat-icon-button [matMenuTriggerFor]="menu"
                                              (click)="stopEventTrigger($event)">
                                              <mat-icon>more_vert</mat-icon>
                                            </button>
                                            <mat-menu #menu="matMenu">
                                              @if (canRollbackSteamingCompleted(row)) {
                                              <button mat-menu-item (click)="onRollbackSteamingJobs($event, row)">
                                                <mat-icon>undo</mat-icon>
                                                <span>{{translatedLangText.REINSTATE}}</span>
                                              </button>
                                              }
                                              @if (canOverwriteSteamingApproval(row)) {
                                              <button mat-menu-item
                                                (click)="overwriteSteamingApprovalDialog($event, row)">
                                                <mat-icon>change_circle</mat-icon>
                                                <span>{{translatedLangText.OVERWRITE_APPROVAL}}</span>
                                              </button>
                                              }
                                            </mat-menu>
                                            }
                                          </mat-cell>
                                        </ng-container>
                                        <mat-header-row *matHeaderRowDef="displayedColumnsSteaming"></mat-header-row>
                                        <mat-row *matRowDef="let row; columns: displayedColumnsSteaming;"
                                          (click)="steamHeatingLogDialog($event, row)" [style.cursor]="'pointer'"
                                          matRipple>
                                        </mat-row>
                                      </table>
                                    </div>
                                    <!-- No result -->
                                    @if (!(steamDS.loading$ | async) && !steamItem.length) {
                                    <div class="no-results">
                                      <mat-divider></mat-divider>
                                      <div class="no-results m-l-20 pt-3">
                                        <h5 class="m-b-15">{{translatedLangText.NO_RESULT}}</h5>
                                      </div>
                                    </div>
                                    }
                                    <!-- Loading spinner -->
                                    @if (steamDS.loading$ | async) {
                                    <div class="tbl-spinner">
                                      <mat-progress-spinner color="primary" [diameter]="40" mode="indeterminate">
                                      </mat-progress-spinner>
                                    </div>
                                    }
                                  </div>
                                </div>
                              </div>
                              }
                              @else{
                              <div class="empty-purpose">
                                <mat-icon class="icon-large">error_outline</mat-icon>
                                <span class="mb-3">{{translatedLangText.NO_STEAM_PURPOSE}}</span>
                                @if (canAddPurpose('steaming')) {
                                <button mat-flat-button color="primary"
                                  (click)="updatePurposeDialog($event, 'steaming', 'add')">
                                  <mat-icon>
                                    add
                                  </mat-icon>
                                  {{translatedLangText.ADD_STEAM_PURPOSE}}
                                </button>
                                }
                              </div>
                              }
                              }
                            </mat-tab>
                            <mat-tab>
                              <ng-template mat-tab-label>
                                <span [ngClass]="'m-r-10 d-flex align-items-center'">
                                  <!-- <i class="fas fa-trash fa-icon m-r-5"></i>{{ translatedLangText.RESIDUE }} -->
                                  <mat-icon class="m-r-5">delete</mat-icon>{{ translatedLangText.RESIDUE }}
                                </span>
                              </ng-template>
                              @if ((residueDS.loading$ | async) || (sotDS.loading$ | async) || (sotDS.actionLoading$ |
                              async)) {
                              <div class="tbl-spinner">
                                <mat-progress-spinner color="primary" [diameter]="40" mode="indeterminate">
                                </mat-progress-spinner>
                              </div>
                              }
                              @if (!(residueDS.loading$ | async) && !(sotDS.loading$ | async) && !(sotDS.actionLoading$
                              | async)) {
                              @if (sot?.purpose_cleaning || residueItem.length) {
                              <div class="row justify-content-center pt-4 pb-3">
                                <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 col-xs-12 m-b-5">
                                  <div class="row right-align-display">
                                    <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                      <span class="label-display-info">{{translatedLangText.BEGIN_DATE}}:</span>
                                    </div>
                                    <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                      <span class="value-display-info">
                                        {{displayDateTime(residueDS.getResidueBeginDate(residueItem)) || "-"}}
                                      </span>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-xl-4 col-lg-6 col-md-12 col-sm-12 col-xs-12 m-b-5">
                                  <div class="row right-align-display">
                                    <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                      <span class="label-display-info">{{translatedLangText.COMPLETE_DATE}}:</span>
                                    </div>
                                    <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                      <span class="value-display-info">
                                        {{displayDateTime(residueDS.getResidueCompleteDate(residueItem)) || "-"}}
                                      </span>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-xl-4 col-lg-6 col-md-12 col-sm-12 col-xs-12 m-b-5">
                                  <div class="row right-align-display">
                                    <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                      <span class="label-display-info">{{translatedLangText.PROCESSING_DAYS}}:</span>
                                    </div>
                                    <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                      <span class="value-display-info">
                                        {{residueDS.getResidueProcessingDays(residueItem) || "-"}}
                                      </span>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <div class="row">
                                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-xs-12 m-b-0">
                                  <div class="responsive_table">
                                    <table mat-table [dataSource]="residueItem" matSort
                                      class="mat-cell advance-tab-table striped-rows hover-highlight dark-header curve-table">
                                      <ng-container matColumnDef="id">
                                        <mat-header-cell *matHeaderCellDef></mat-header-cell>
                                        <mat-cell *matCellDef="let row">{{row.guid}}</mat-cell>
                                      </ng-container>
                                      <ng-container matColumnDef="estimate_no">
                                        <mat-header-cell mat-header-cell *matHeaderCellDef
                                          [ngClass]="'tbl-col-width-per-1_25-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm justify-content-center'">
                                          {{translatedLangText.ESTIMATE_NO}}
                                        </mat-header-cell>
                                        <mat-cell mat-cell *matCellDef="let row"
                                          [ngClass]="'tbl-col-width-per-1_25-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm justify-content-center'">
                                          <span
                                            class="mobile-tab-label">{{translatedLangText.ESTIMATE_NO}}:</span>{{row.estimate_no}}
                                        </mat-cell>
                                      </ng-container>
                                      <ng-container matColumnDef="estimate_date">
                                        <mat-header-cell mat-header-cell *matHeaderCellDef
                                          [ngClass]="'tbl-col-width-per-1_75-xl tbl-col-width-per-1_75-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm justify-content-center'">
                                          {{translatedLangText.ESTIMATE_DATE}}
                                        </mat-header-cell>
                                        <mat-cell mat-cell *matCellDef="let row"
                                          [ngClass]="'tbl-col-width-per-1_75-xl tbl-col-width-per-1_75-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm justify-content-center'">
                                          <span class="mobile-tab-label">{{translatedLangText.ESTIMATE_DATE}}:</span>
                                          <span>{{displayDate(row.create_dt) ?? "-"}}</span>
                                        </mat-cell>
                                      </ng-container>
                                      <ng-container matColumnDef="approve_dt">
                                        <mat-header-cell mat-header-cell *matHeaderCellDef
                                          [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm justify-content-center'">
                                          {{translatedLangText.APPROVED_NO_ACTION}}
                                        </mat-header-cell>
                                        <mat-cell mat-cell *matCellDef="let row"
                                          [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm justify-content-center'">
                                          <span
                                            class="mobile-tab-label">{{translatedLangText.APPROVED_NO_ACTION}}:</span>
                                          <span>{{displayDate(row.approve_dt) ?? "-"}}</span>
                                        </mat-cell>
                                      </ng-container>
                                      <ng-container matColumnDef="allocation_dt">
                                        <mat-header-cell mat-header-cell *matHeaderCellDef
                                          [ngClass]="'tbl-col-width-per-1_75-xl tbl-col-width-per-1_75-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm justify-content-center'">
                                          {{translatedLangText.ALLOCATION_DATE}}
                                        </mat-header-cell>
                                        <mat-cell mat-cell *matCellDef="let row"
                                          [ngClass]="'tbl-col-width-per-1_75-xl tbl-col-width-per-1_75-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm justify-content-center'">
                                          <span class="mobile-tab-label">{{translatedLangText.ALLOCATION_DATE}}:</span>
                                          <span>{{displayDate(row.allocate_dt) ?? "-"}}</span>
                                        </mat-cell>
                                      </ng-container>
                                      <ng-container matColumnDef="qc_dt">
                                        <mat-header-cell mat-header-cell *matHeaderCellDef
                                          [ngClass]="'tbl-col-width-per-1_75-xl tbl-col-width-per-1_75-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm justify-content-center'">
                                          {{translatedLangText.COMPLETED_DATE}}
                                        </mat-header-cell>
                                        <mat-cell mat-cell *matCellDef="let row"
                                          [ngClass]="'tbl-col-width-per-1_75-xl tbl-col-width-per-1_75-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm justify-content-center'">
                                          <span class="mobile-tab-label">{{translatedLangText.COMPLETED_DATE}}:</span>
                                          <span>{{displayDate(row.complete_dt) ?? "-"}}</span>
                                        </mat-cell>
                                      </ng-container>
                                      <ng-container matColumnDef="status_cv">
                                        <mat-header-cell mat-header-cell *matHeaderCellDef
                                          [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm justify-content-center'">
                                          {{translatedLangText.STATUS}}
                                        </mat-header-cell>
                                        <mat-cell mat-cell *matCellDef="let row"
                                          [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm justify-content-center'">
                                          <span
                                            class="mobile-tab-label">{{translatedLangText.STATUS}}:</span>{{getProcessStatusDescription(row?.status_cv)}}
                                        </mat-cell>
                                      </ng-container>
                                      <ng-container matColumnDef="actions">
                                        <mat-header-cell
                                          [ngClass]="'tbl-col-width-per-1_75-xl tbl-col-width-per-12-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm justify-content-center'"
                                          *matHeaderCellDef>
                                        </mat-header-cell>
                                        <mat-cell *matCellDef="let row; let i=index;"
                                          [ngClass]="'tbl-col-width-per-1_75-xl tbl-col-width-per-12-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm pr-0 justify-content-center'">
                                          <button mat-icon-button [matMenuTriggerFor]="menu"
                                            (click)="stopEventTrigger($event)">
                                            <mat-icon>more_vert</mat-icon>
                                          </button>
                                          <mat-menu #menu="matMenu">
                                            @if (canRollbackResidueCompleted(row)) {
                                            <button mat-menu-item (click)="onRollbackResidueJobs($event, row)">
                                              <mat-icon>undo</mat-icon>
                                              <span>{{translatedLangText.REINSTATE}}</span>
                                            </button>
                                            }
                                            @if (canOverwriteResidueApproval(row)) {
                                            <button mat-menu-item (click)="overwriteResidueApprovalDialog($event, row)">
                                              <mat-icon>edit</mat-icon>
                                              <span>{{translatedLangText.APPROVAL}}</span>
                                            </button>
                                            }
                                            <!-- <button mat-menu-item (click)="exportResidueEst($event, row)">
                                              <mat-icon>edit</mat-icon>
                                              <span>{{translatedLangText.OVERWRITE_APPROVAL}}</span>
                                            </button> -->
                                          </mat-menu>
                                        </mat-cell>
                                      </ng-container>
                                      <mat-header-row *matHeaderRowDef="displayedColumnsResidue"></mat-header-row>
                                      <mat-row *matRowDef="let row; columns: displayedColumnsResidue;"
                                        [style.cursor]="'pointer'" (click)="ViewResidueEstimateItem(row)" matRipple>
                                      </mat-row>
                                    </table>
                                  </div>
                                  <!-- No result -->
                                  @if (!(residueDS.loading$ | async) && !residueItem.length) {
                                  <div class="no-results">
                                    <mat-divider></mat-divider>
                                    <div class="no-results m-l-20 pt-3">
                                      <h5 class="m-b-15">{{translatedLangText.NO_RESULT}}</h5>
                                    </div>
                                  </div>
                                  }
                                  <!-- Loading spinner -->
                                  @if (residueDS.loading$ | async) {
                                  <div class="tbl-spinner">
                                    <mat-progress-spinner color="primary" [diameter]="40" mode="indeterminate">
                                    </mat-progress-spinner>
                                  </div>
                                  }
                                </div>
                              </div>
                              }
                              @else {
                              <div class="empty-purpose">
                                <mat-icon class="icon-large">error_outline</mat-icon>
                                <span class="mb-3">{{translatedLangText.NO_RESIDUE}}</span>
                              </div>
                              }
                              }
                            </mat-tab>
                            }
                            <mat-tab>
                              <ng-template mat-tab-label>
                                <span [ngClass]="'m-r-10 d-flex align-items-center'">
                                  <!-- <i class="fas fa-magic fa-icon m-r-5"></i>{{ translatedLangText.CLEANING }} -->
                                  <mat-icon class="m-r-5">water_drop</mat-icon>{{ translatedLangText.CLEANING }}
                                </span>
                              </ng-template>
                              @if ((cleaningDS.loading$ | async) || (sotDS.loading$ | async) || (sotDS.actionLoading$ |
                              async)) {
                              <div class="tbl-spinner">
                                <mat-progress-spinner color="primary" [diameter]="40" mode="indeterminate">
                                </mat-progress-spinner>
                              </div>
                              }
                              @if (!(cleaningDS.loading$ | async) && !(sotDS.loading$ | async) && !(sotDS.actionLoading$
                              | async)) {
                              @if (sot?.purpose_cleaning) {
                              <div class="position-relative">
                                @if ((canOverwriteCleaningApproval() && allowPerformAction()) ||
                                canRollbackCleaningCompleted(cleaningItem?.[0])
                                || canRollbackCleaning(cleaningItem?.[0]) || canRemoveCleanPurpose()) {
                                <button mat-mini-fab color="primary" [matMenuTriggerFor]="menu"
                                  [disabled]="(cleaningDS.loading$ | async)"
                                  class="link-button position-absolute purpose-absolute-menu">
                                  <mat-icon>edit</mat-icon>
                                </button>

                                <mat-menu #menu="matMenu">
                                  @if (canOverwriteCleaningApproval() && allowPerformAction()) {
                                  <button mat-menu-item
                                    (click)="overwriteCleaningApprovalDialog($event)">{{translatedLangText.APPROVAL}}</button>
                                  }
                                  @if (canRollbackCleaningCompleted(cleaningItem?.[0])) {
                                  <button mat-menu-item class=""
                                    (click)="onRollbackCleaningJobs($event, cleaningItem?.[0])">{{translatedLangText.REINSTATE}}</button>
                                  }
                                  @if (canRollbackCleaning(cleaningItem?.[0])) {
                                  <button mat-menu-item class=""
                                    (click)="onRollbackCleaning($event, cleaningItem?.[0])">{{translatedLangText.REINSTATE}}</button>
                                  }
                                  @if (canRemoveCleanPurpose()) {
                                  <button mat-menu-item class=""
                                    (click)="updatePurposeDialog($event, 'cleaning', 'remove')">{{translatedLangText.REMOVE}}</button>
                                  }
                                </mat-menu>
                                }
                                <div class="row justify-content-center pt-5">
                                  <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 col-xs-12 m-b-5">
                                    <div class="row right-align-display">
                                      <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                        <span class="label-display-info">{{translatedLangText.GATE_IN_DATE}}:</span>
                                      </div>
                                      <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                        <span class="value-display-info">
                                          {{displayDate(cleaningItem?.[0]?.create_dt) || "-"}}
                                        </span>
                                      </div>
                                    </div>
                                    <div class="row right-align-display">
                                      <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                        <span class="label-display-info">{{translatedLangText.APPROVED_DATE}}:</span>
                                      </div>
                                      <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                        <span class="value-display-info">
                                          {{displayDate(cleaningItem?.[0]?.approve_dt) || "-"}}
                                        </span>
                                      </div>
                                    </div>
                                    <div class="row right-align-display">
                                      <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                        <span class="label-display-info">{{translatedLangText.JOB_STATUS}}:</span>
                                      </div>
                                      <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                        <span class="value-display-info">
                                          {{getProcessStatusDescription(cleaningItem?.[0]?.status_cv) || "-"}}
                                        </span>
                                      </div>
                                    </div>
                                    <div class="row right-align-display">
                                      <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                        <span class="label-display-info">{{translatedLangText.BILL}}:</span>
                                      </div>
                                      <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                        <span class="value-display-info align-items-center">
                                          @if (cleaningItem?.[0]?.customer_billing_guid) {
                                          <mat-icon
                                            class="material-icons-two-tone col-green font-bold m-l-0">check</mat-icon>
                                          }
                                          @else {
                                          <mat-icon
                                            class="material-icons-two-tone col-red font-bold m-l-0">close</mat-icon>
                                          }
                                        </span>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 col-xs-12 m-b-5">
                                    <div class="row right-align-display">
                                      <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                        <span class="label-display-info">{{translatedLangText.PROCESS}}:</span>
                                      </div>
                                      <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                        <span class="value-display-info">
                                          {{sot?.tariff_cleaning?.cleaning_method?.name || "-"}}
                                        </span>
                                      </div>
                                    </div>
                                    <div class="row right-align-display">
                                      <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                        <span class="label-display-info">{{translatedLangText.CLEANING_BAY}}:</span>
                                      </div>
                                      <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                        <span class="value-display-info">
                                          {{cleaningItem?.[0]?.job_order?.team?.description || "-"}}
                                        </span>
                                      </div>
                                    </div>
                                    <div class="row right-align-display">
                                      <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                        <span class="label-display-info">{{translatedLangText.JOB_NO}}:</span>
                                      </div>
                                      <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                        <span class="value-display-info">
                                          {{cleaningItem?.[0]?.job_no || "-"}}
                                        </span>
                                      </div>
                                    </div>

                                  </div>
                                  <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 col-xs-12 m-b-5">

                                    <div class="row right-align-display">
                                      <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                        <span class="label-display-info">{{translatedLangText.BEGIN_DATE}}:</span>
                                      </div>
                                      <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                        <span class="value-display-info">
                                          {{displayDateTime(cleaningItem?.[0]?.job_order?.start_dt) || "-"}}
                                        </span>
                                      </div>
                                    </div>
                                    <div class="row right-align-display">
                                      <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                        <span class="label-display-info">{{translatedLangText.COMPLETED_DATE}}:</span>
                                      </div>
                                      <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                        <span class="value-display-info">
                                          {{displayDateTime(cleaningItem?.[0]?.job_order?.complete_dt) || "-"}}
                                        </span>
                                      </div>
                                    </div>
                                    <div class="row right-align-display">
                                      <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                        <span
                                          class="label-display-info">{{translatedLangText.DURATION_DAY_HR_MIN}}:</span>
                                      </div>
                                      <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                        <span class="value-display-info">
                                          {{joDS.getJobOrderDuration(cleaningItem?.[0]?.job_order) || "-"}}
                                        </span>
                                      </div>
                                    </div>

                                  </div>
                                </div>
                              </div>
                              }
                              @else{
                              <div class="empty-purpose">
                                <mat-icon class="icon-large">error_outline</mat-icon>
                                <span class="mb-3">{{translatedLangText.NO_CLEANING_PURPOSE}}</span>
                                @if (canAddPurpose('cleaning')) {
                                <button mat-flat-button color="primary"
                                  (click)="updatePurposeDialog($event, 'cleaning', 'add')">
                                  <mat-icon>
                                    add
                                  </mat-icon>
                                  {{translatedLangText.ADD_CLEANING_PURPOSE}}
                                </button>
                                }
                              </div>
                              }
                              }
                            </mat-tab>

                            <mat-tab>
                              <ng-template mat-tab-label>
                                <span [ngClass]="'m-r-10 d-flex align-items-center'">
                                  <mat-icon class="m-r-5">build</mat-icon>{{ translatedLangText.REPAIR }}
                                </span>
                              </ng-template>
                              @if (!(repairDS.loading$ | async) && !(sotDS.loading$ | async) && !(sotDS.actionLoading$ |
                              async)) {
                              @if (sot?.purpose_repair_cv) {
                              <div class="position-relative mt-2">
                                @if (canRemoveRepairPurpose()) {
                                <button mat-mini-fab color="primary" [matMenuTriggerFor]="menu"
                                  [disabled]="(cleaningDS.loading$ | async)"
                                  class="link-button position-absolute purpose-absolute-menu">
                                  <mat-icon>edit</mat-icon>
                                </button>

                                <mat-menu #menu="matMenu">
                                  @if (canRemoveRepairPurpose()) {
                                  <button mat-menu-item class=""
                                    (click)="updatePurposeDialog($event, 'repair', 'remove')">{{translatedLangText.REMOVE}}</button>
                                  }
                                </mat-menu>
                                }
                                <!-- @if (canRemoveRepairPurpose()) {
                                <button color="warn" [matTooltip]="translatedLangText.REMOVE_REPAIR_PURPOSE"
                                  (click)="updatePurposeDialog($event, 'repair', 'remove')"
                                  class="link-button text-danger position-absolute top-0 end-0 p-0">
                                  <mat-icon>cancel</mat-icon>
                                </button>
                                } -->
                                <div class="row justify-content-center pt-4 pb-3">
                                  <div class="col-xl-5 col-lg-6 col-md-12 col-sm-12 col-xs-12 m-b-5 ">
                                    <div class="row right-align-display">
                                      <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                        <span class="label-display-info">{{translatedLangText.BEGIN_DATE}}:</span>
                                      </div>
                                      <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                        <span class="value-display-info">
                                          {{displayDateTime(repairDS.getRepairBeginDate(repairItem)) || "-"}}
                                        </span>
                                      </div>
                                    </div>
                                    <div class="row right-align-display">
                                      <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                        <span class="label-display-info">{{translatedLangText.REPAIR_TYPE}}:</span>
                                      </div>
                                      <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                        <span class="value-display-info">
                                          {{getPurposeOptionDescription(sot!.purpose_repair_cv) || "-"}}
                                        </span>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="col-xl-5 col-lg-6 col-md-12 col-sm-12 col-xs-12 m-b-5">
                                    <div class="row right-align-display">
                                      <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                        <span class="label-display-info">{{translatedLangText.COMPLETE_DATE}}:</span>
                                      </div>
                                      <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                        <span class="value-display-info">
                                          {{displayDateTime(repairDS.getRepairCompleteDate(repairItem)) || "-"}}
                                        </span>
                                      </div>
                                    </div>
                                    <div class="row right-align-display">
                                      <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5 col-xs-5 m-b-5">
                                        <span class="label-display-info">{{translatedLangText.DURATION}}:</span>
                                      </div>
                                      <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-xs-7 m-b-5">
                                        <span class="value-display-info">
                                          {{repairDS.getRepairProcessingDays(repairItem) || "-"}}
                                        </span>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                                <div class="row">
                                  <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-xs-12 m-b-0">
                                    <div class="responsive_table">
                                      <table mat-table [dataSource]="repairItem" matSort
                                        class="mat-cell advance-tab-table striped-rows hover-highlight dark-header curve-table">
                                        <ng-container matColumnDef="id">
                                          <mat-header-cell *matHeaderCellDef></mat-header-cell>
                                          <mat-cell *matCellDef="let row">{{row.guid}}</mat-cell>
                                        </ng-container>
                                        <ng-container matColumnDef="estimate_no">
                                          <mat-header-cell mat-header-cell *matHeaderCellDef
                                            [ngClass]="'tbl-col-width-per-1_25-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm justify-content-center'">
                                            {{translatedLangText.ESTIMATE_NO}}
                                          </mat-header-cell>
                                          <mat-cell mat-cell *matCellDef="let row"
                                            [ngClass]="'tbl-col-width-per-1_25-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm justify-content-center'">
                                            <span
                                              class="mobile-tab-label">{{translatedLangText.ESTIMATE_NO}}:</span>{{row.estimate_no}}
                                          </mat-cell>
                                        </ng-container>
                                        <ng-container matColumnDef="estimate_date">
                                          <mat-header-cell mat-header-cell *matHeaderCellDef
                                            [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm justify-content-center'">
                                            {{translatedLangText.ESTIMATE_DATE}}
                                          </mat-header-cell>
                                          <mat-cell mat-cell *matCellDef="let row"
                                            [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm justify-content-center'">
                                            <span class="mobile-tab-label">{{translatedLangText.ESTIMATE_DATE}}:</span>
                                            <span>{{displayDate(row.create_dt) ?? "-"}}</span>
                                          </mat-cell>
                                        </ng-container>
                                        <ng-container matColumnDef="approve_dt">
                                          <mat-header-cell mat-header-cell *matHeaderCellDef
                                            [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm justify-content-center'">
                                            {{translatedLangText.APPROVED_NO_ACTION}}
                                          </mat-header-cell>
                                          <mat-cell mat-cell *matCellDef="let row"
                                            [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm justify-content-center'">
                                            <span
                                              class="mobile-tab-label">{{translatedLangText.APPROVED_NO_ACTION}}:</span>
                                            <span>{{displayDate(row.approve_dt) ?? "-"}}</span>
                                          </mat-cell>
                                        </ng-container>
                                        <ng-container matColumnDef="allocation_dt">
                                          <mat-header-cell mat-header-cell *matHeaderCellDef
                                            [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm justify-content-center'">
                                            {{translatedLangText.ALLOCATION_DATE}}
                                          </mat-header-cell>
                                          <mat-cell mat-cell *matCellDef="let row"
                                            [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm justify-content-center'">
                                            <span
                                              class="mobile-tab-label">{{translatedLangText.ALLOCATION_DATE}}:</span>
                                            <span>{{displayDate(row.allocate_dt) ?? "-"}}</span>
                                          </mat-cell>
                                        </ng-container>
                                        <ng-container matColumnDef="qc_dt">
                                          <mat-header-cell mat-header-cell *matHeaderCellDef
                                            [ngClass]="'tbl-col-width-per-1_25-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm justify-content-center'">
                                            {{translatedLangText.QC_DATE}}
                                          </mat-header-cell>
                                          <mat-cell mat-cell *matCellDef="let row"
                                            [ngClass]="'tbl-col-width-per-1_25-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm justify-content-center'">
                                            <span class="mobile-tab-label">{{translatedLangText.QC_DATE}}:</span>
                                            <span>{{displayDate(repairDS.getRepairJobQcDt(row)) ?? "-"}}</span>
                                          </mat-cell>
                                        </ng-container>
                                        <ng-container matColumnDef="status_cv">
                                          <mat-header-cell mat-header-cell *matHeaderCellDef
                                            [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm justify-content-center'">
                                            {{translatedLangText.STATUS}}
                                          </mat-header-cell>
                                          <mat-cell mat-cell *matCellDef="let row"
                                            [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm justify-content-center'">
                                            <span
                                              class="mobile-tab-label">{{translatedLangText.STATUS}}:</span>{{getProcessStatusDescription(row?.status_cv)}}
                                          </mat-cell>
                                        </ng-container>
                                        <ng-container matColumnDef="actions">
                                          <mat-header-cell
                                            [ngClass]="'tbl-col-width-per-1_75-xl tbl-col-width-per-12-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm justify-content-center'"
                                            *matHeaderCellDef>
                                          </mat-header-cell>
                                          <mat-cell *matCellDef="let row; let i=index;"
                                            [ngClass]="'tbl-col-width-per-1_75-xl tbl-col-width-per-12-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm pr-0 justify-content-center'">
                                            @if ((canRollbackRepairQC(row) && allowPerformAction()) ||
                                            canRollbackRepairQC(row) || canOverwriteRepairApproval(row)) {
                                            <button mat-icon-button [matMenuTriggerFor]="menu"
                                              (click)="stopEventTrigger($event)">
                                              <mat-icon>more_vert</mat-icon>
                                            </button>
                                            <mat-menu #menu="matMenu">
                                              @if (canRollbackRepairQC(row) && allowPerformAction()) {
                                              <button mat-menu-item (click)="onOverwriteQC($event, row)">
                                                <mat-icon>edit</mat-icon>
                                                <span>{{translatedLangText.QC}}</span>
                                              </button>
                                              }
                                              @if (canOverwriteRepairApproval(row)) {
                                              <button mat-menu-item
                                                (click)="overwriteRepairApprovalDialog($event, row)">
                                                <mat-icon>edit</mat-icon>
                                                <span>{{translatedLangText.APPROVAL}}</span>
                                              </button>
                                              }
                                              @if (canRollbackRepairQC(row)) {
                                              <button mat-menu-item (click)="onRollbackRepairQC($event, row)">
                                                <mat-icon>undo</mat-icon>
                                                <span>{{translatedLangText.REINSTATE}}</span>
                                              </button>
                                              }
                                            </mat-menu>
                                            }
                                          </mat-cell>
                                        </ng-container>
                                        <mat-header-row *matHeaderRowDef="displayedColumnsRepair"></mat-header-row>
                                        <mat-row *matRowDef="let row; columns: displayedColumnsRepair;"
                                          (click)="repairDialog($event, row)" [style.cursor]="'pointer'" matRipple>
                                        </mat-row>
                                      </table>
                                    </div>
                                    <!-- No result -->
                                    @if (!(repairDS.loading$ | async) && !repairItem.length) {
                                    <div class="no-results">
                                      <mat-divider></mat-divider>
                                      <div class="no-results m-l-20 pt-3">
                                        <h5 class="m-b-15">{{translatedLangText.NO_RESULT}}</h5>
                                      </div>
                                    </div>
                                    }
                                    <!-- Loading spinner -->
                                    @if (repairDS.loading$ | async) {
                                    <div class="tbl-spinner">
                                      <mat-progress-spinner color="primary" [diameter]="40" mode="indeterminate">
                                      </mat-progress-spinner>
                                    </div>
                                    }
                                  </div>
                                </div>
                              </div>
                              }
                              @else {
                              <div class="empty-purpose">
                                <mat-icon class="icon-large">error_outline</mat-icon>
                                <span class="mb-3">{{translatedLangText.NO_REPAIR_PURPOSE}}</span>
                                @if (canAddPurpose('repair')) {
                                <button mat-flat-button color="primary"
                                  (click)="updatePurposeDialog($event, 'repair', 'add')">
                                  <mat-icon>
                                    add
                                  </mat-icon>
                                  {{translatedLangText.ADD_REPAIR_PURPOSE}}
                                </button>
                                }
                              </div>
                              }
                              }
                            </mat-tab>
                          </mat-tab-group>
                        </div>
                      </div>
                    </mat-card-content>
                  </div>
                </mat-expansion-panel>
                <mat-expansion-panel [expanded]="verifySection(accordionSections.depot_cost_details)">
                  <mat-expansion-panel-header class="ps-0 tank-header"
                    (click)="setSection(accordionSections.depot_cost_details)">
                    <mat-panel-title>
                      <div class="d-flex justify-content-between align-items-center w-100">
                        <div class="header">
                          <h2>
                            {{translatedLangText.DEPOT_COST_DETAILS}}
                          </h2>
                        </div>
                        <button mat-icon-button (click)="expandAll($event, accordionSections.depot_cost_details)"
                          [matTooltip]="!isAllExpand() ? translatedLangText.EXPAND_ALL : translatedLangText.COLLAPSE_ALL">
                          <mat-icon>unfold_more</mat-icon>
                        </button>
                      </div>
                    </mat-panel-title>
                  </mat-expansion-panel-header>
                  <div class="body p-l-0 p-r-0">
                    @if ((pdDS.loading$ | async)) {
                    <div class="tbl-spinner">
                      <mat-progress-spinner color="primary" [diameter]="40" mode="indeterminate">
                      </mat-progress-spinner>
                    </div>
                    }
                    @if (!(pdDS.loading$ | async)) {
                    <mat-card-content>
                      <div class="position-relative">
                        @if(allowPerformAction()) {
                        <div class="relative-menu">
                          @if (canOverwriteJobNo() && canOverwriteDepotCost()) {
                          <button mat-mini-fab color="primary" [matMenuTriggerFor]="menu"
                            [disabled]="(pdDS.actionLoading$ | async)" class="me-2">
                            <mat-icon>edit</mat-icon>
                          </button>
                          <mat-menu #menu="matMenu">
                            @if (canOverwriteJobNo()) {
                            <button mat-menu-item
                              (click)="overwriteJobNoDialog($event)">{{translatedLangText.JOB_NO}}</button>
                            }
                            @if (canOverwriteDepotCost()) {
                            <button mat-menu-item
                              (click)="overwriteDepotCostDialog($event)">{{translatedLangText.DEPOT_COST}}</button>
                            }
                          </mat-menu>
                          }
                        </div>
                        }
                        <div class="row">
                          <div
                            class="col-xl-4 col-lg-12 col-md-12 col-sm-12 col-xs-12 mt-xl-0 mt-lg-4 mt-md-4 mt-sm-4 mt-xs-4 m-t-70 m-b-0">
                            <div class="row justify-content-center">
                              <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-xs-12 m-b-5">
                                <div class="row">
                                  <div
                                    class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-xs-12 m-b-5 d-flex justify-content-center">
                                    <h6 class="font-bold text-decoration-underline">
                                      {{translatedLangText.STORAGE_BILLING_DETAILS}}
                                    </h6>
                                  </div>
                                </div>
                                <div class="row right-align-display">
                                  <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-xs-6 m-b-5">
                                    <span class="label-display-info">{{translatedLangText.BILLING_PROFILE}}:</span>
                                  </div>
                                  <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-xs-6 m-b-5">
                                    <span class="value-display-info">
                                      {{pdItem?.tariff_depot?.description}}
                                    </span>
                                  </div>
                                </div>
                                <div class="row right-align-display">
                                  <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-xs-6 m-b-5">
                                    <span class="label-display-info">{{translatedLangText.STORAGE_CALCULATE_BY}}:</span>
                                  </div>
                                  <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-xs-6 m-b-5">
                                    <span class="value-display-info">
                                      {{getStorageCalDescription(pdItem?.storage_cal_cv) ?? "-"}}
                                    </span>
                                  </div>
                                </div>
                                <div class="row right-align-display">
                                  <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-xs-6 m-b-5">
                                    <span class="label-display-info">{{translatedLangText.FREE_STORAGE_DAYS}}:</span>
                                  </div>
                                  <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-xs-6 m-b-5">
                                    <span class="value-display-info">
                                      {{pdItem?.free_storage || "-"}}
                                    </span>
                                  </div>
                                </div>
                                <div class="row right-align-display">
                                  <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-xs-6 m-b-5">
                                    <span class="label-display-info">{{translatedLangText.BEGIN_DATE}}:</span>
                                  </div>
                                  <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-xs-6 m-b-5">
                                    <span class="value-display-info">
                                      {{displayDate(pdDS.getStorageBeginDate(sot!, sot?.billing_sot?.storage_cal_cv!))
                                      || "-"}}
                                    </span>
                                  </div>
                                </div>
                                <div class="row right-align-display">
                                  <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-xs-6 m-b-5">
                                    <span class="label-display-info">{{translatedLangText.BILLED_UNTIL}}:</span>
                                  </div>
                                  <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-xs-6 m-b-5">
                                    <span class="value-display-info">
                                      {{displayDate(ogDS.getOutGateItem(sot?.out_gate)?.create_dt) || "-"}}
                                    </span>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="col-xl-7 col-lg-12 col-md-12 col-sm-12 col-xs-12 m-b-0">
                            <div class="responsive_table">
                              <table mat-table [dataSource]="sotDepotCostDetails" matSort
                                class="mat-cell advance-tab-table striped-rows hover-highlight dark-header curve-table">
                                <ng-container matColumnDef="description">
                                  <mat-header-cell mat-header-cell *matHeaderCellDef [ngClass]="''">
                                    {{translatedLangText.DESCRIPTION}}
                                  </mat-header-cell>
                                  <mat-cell mat-cell *matCellDef="let row" [ngClass]="''">
                                    <span
                                      class="mobile-tab-label">{{translatedLangText.DESCRIPTION}}:</span>{{row.description}}
                                  </mat-cell>
                                </ng-container>
                                <ng-container matColumnDef="job_no">
                                  <mat-header-cell mat-header-cell *matHeaderCellDef [ngClass]="''">
                                    {{translatedLangText.JOB_NO}}
                                  </mat-header-cell>
                                  <mat-cell mat-cell *matCellDef="let row" [ngClass]="''">
                                    <span class="mobile-tab-label">{{translatedLangText.JOB_NO}}:</span>
                                    <span>{{row.job_no ?? "-"}}</span>
                                  </mat-cell>
                                </ng-container>
                                <ng-container matColumnDef="invoice">
                                  <mat-header-cell mat-header-cell *matHeaderCellDef [ngClass]="''">
                                    {{translatedLangText.INVOICE}}
                                  </mat-header-cell>
                                  <mat-cell mat-cell *matCellDef="let row" [ngClass]="''">
                                    <span class="mobile-tab-label">{{translatedLangText.INVOICE}}:</span>
                                    <span>
                                      {{row.invoice_no || "-"}}
                                    </span>
                                  </mat-cell>
                                </ng-container>
                                <ng-container matColumnDef="cost">
                                  <mat-header-cell mat-header-cell *matHeaderCellDef [ngClass]="''">
                                    {{translatedLangText.AMOUNT_$}}
                                  </mat-header-cell>
                                  <mat-cell mat-cell *matCellDef="let row" [ngClass]="''">
                                    <span class="mobile-tab-label">{{translatedLangText.AMOUNT_$}}:</span>
                                    <span>{{parse2Decimal(row.cost!) || '-'}}</span>
                                  </mat-cell>
                                </ng-container>
                                <mat-header-row *matHeaderRowDef="displayedColumnsDepotCostDetails"></mat-header-row>
                                <mat-row *matRowDef="let row; columns: displayedColumnsDepotCostDetails;"
                                  [style.cursor]="'pointer'" matRipple>
                                </mat-row>
                              </table>
                            </div>
                            <!-- No result -->
                            @if (!(sotDS.loading$ | async) && !sotDepotCostDetails.length) {
                            <!-- <div class="no-results">
                              <mat-divider></mat-divider>
                              <div class="no-results m-l-20 pt-3">
                                <h5 class="m-b-15">{{translatedLangText.NO_RESULT}}</h5>
                              </div>
                            </div> -->
                            }
                            <!-- Loading spinner -->
                            @if (sotDS.loading$ | async) {
                            <div class="tbl-spinner">
                              <mat-progress-spinner color="primary" [diameter]="40" mode="indeterminate">
                              </mat-progress-spinner>
                            </div>
                            }
                          </div>
                        </div>
                      </div>
                    </mat-card-content>
                    }
                  </div>
                </mat-expansion-panel>
                <mat-expansion-panel class="alternate-panel"
                  [expanded]="verifySection(accordionSections.booking_details)">
                  <mat-expansion-panel-header class="ps-0 tank-header"
                    (click)="setSection(accordionSections.booking_details)">
                    <mat-panel-title>
                      <div class="d-flex justify-content-between align-items-center w-100">
                        <div class="header">
                          <h2>
                            {{translatedLangText.BOOKING_DETAILS}}
                          </h2>
                        </div>
                        <button mat-icon-button (click)="expandAll($event, accordionSections.booking_details)"
                          [matTooltip]="!isAllExpand() ? translatedLangText.EXPAND_ALL : translatedLangText.COLLAPSE_ALL">
                          <mat-icon>unfold_more</mat-icon>
                        </button>
                      </div>
                    </mat-panel-title>
                  </mat-expansion-panel-header>
                  <div class="body p-l-0 p-t-0 p-r-0">
                    @if ((bkDS.loading$ | async) || (schedulingDS.loading$ | async)) {
                    <div class="tbl-spinner">
                      <mat-progress-spinner color="primary" [diameter]="40" mode="indeterminate">
                      </mat-progress-spinner>
                    </div>
                    }
                    @if (!(bkDS.loading$ | async) && !(schedulingDS.loading$ | async)) {
                    <mat-card-content>
                      <div class="row">
                        <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-xs-12 m-b-0">
                          @if (allowedTabs.length > 1) {
                          <mat-tab-group class="tlx-mdc-tab-group" dynamicHeight>
                            @for (tab of allowedTabs; track tab.label) {
                            @if (tab.component == 'booking') {
                            <mat-tab>
                              <ng-template mat-tab-label>
                                <span [ngClass]="'m-r-10 d-flex align-items-center'">
                                  {{translatedLangText.BOOKING}}
                                </span>
                              </ng-template>
                              <div class="responsive_table">
                                <table mat-table [dataSource]="bookingList" matSort
                                  class="mat-cell advance-tab-table striped-rows hover-highlight dark-header curve-table">
                                  <ng-container matColumnDef="id">
                                    <mat-header-cell *matHeaderCellDef></mat-header-cell>
                                    <mat-cell *matCellDef="let row">{{row.guid}}</mat-cell>
                                  </ng-container>
                                  <ng-container matColumnDef="book_type_cv">
                                    <mat-header-cell mat-header-cell *matHeaderCellDef [ngClass]="''">
                                      {{translatedLangText.BOOKING_TYPE}}
                                    </mat-header-cell>
                                    <mat-cell mat-cell *matCellDef="let row" [ngClass]="''">
                                      <span
                                        class="mobile-tab-label">{{translatedLangText.BOOKING_TYPE}}:</span>{{getBookingTypeDescription(row.book_type_cv)}}
                                    </mat-cell>
                                  </ng-container>
                                  <ng-container matColumnDef="booking_dt">
                                    <mat-header-cell mat-header-cell *matHeaderCellDef [ngClass]="''">
                                      {{translatedLangText.DATE}}
                                    </mat-header-cell>
                                    <mat-cell mat-cell *matCellDef="let row" [ngClass]="''">
                                      <span class="mobile-tab-label">{{translatedLangText.DATE}}:</span>
                                      <span>{{displayDate(row.booking_dt) ?? "-"}}</span>
                                    </mat-cell>
                                  </ng-container>
                                  <ng-container matColumnDef="reference">
                                    <mat-header-cell mat-header-cell *matHeaderCellDef [ngClass]="''">
                                      {{translatedLangText.REFERENCE}}
                                    </mat-header-cell>
                                    <mat-cell mat-cell *matCellDef="let row" [ngClass]="''">
                                      <span class="mobile-tab-label">{{translatedLangText.REFERENCE}}:</span>
                                      <span>{{row.reference ?? "-"}}</span>
                                    </mat-cell>
                                  </ng-container>
                                  <ng-container matColumnDef="surveyor">
                                    <mat-header-cell mat-header-cell *matHeaderCellDef [ngClass]="''">
                                      {{translatedLangText.SURVEYOR}}
                                    </mat-header-cell>
                                    <mat-cell mat-cell *matCellDef="let row" [ngClass]="''">
                                      <span class="mobile-tab-label">{{translatedLangText.SURVEYOR}}:</span>
                                      <span>{{row.test_class_cv ?? "-"}}</span>
                                    </mat-cell>
                                  </ng-container>
                                  <ng-container matColumnDef="status_cv">
                                    <mat-header-cell mat-header-cell *matHeaderCellDef [ngClass]="''">
                                      {{translatedLangText.STATUS}}
                                    </mat-header-cell>
                                    <mat-cell mat-cell *matCellDef="let row" [ngClass]="''">
                                      <span
                                        class="mobile-tab-label">{{translatedLangText.STATUS}}:</span>{{getBookingStatusDescription(row?.status_cv)}}
                                    </mat-cell>
                                  </ng-container>
                                  <mat-header-row *matHeaderRowDef="displayedColumnsBooking"></mat-header-row>
                                  <mat-row *matRowDef="let row; columns: displayedColumnsBooking;"
                                    [style.cursor]="'pointer'" matRipple>
                                  </mat-row>
                                </table>
                              </div>
                              <!-- No result -->
                              @if (!(bkDS.loading$ | async) && !bookingList.length) {
                              <div class="no-results">
                                <mat-divider></mat-divider>
                                <div class="no-results m-l-20 pt-3">
                                  <h5 class="m-b-15">{{translatedLangText.NO_RESULT}}</h5>
                                </div>
                              </div>
                              }
                              <!-- Loading spinner -->
                              @if (bkDS.loading$ | async) {
                              <div class="tbl-spinner">
                                <mat-progress-spinner color="primary" [diameter]="40" mode="indeterminate">
                                </mat-progress-spinner>
                              </div>
                              }
                            </mat-tab>
                            }
                            @if (tab.component == 'scheduling') {
                            <mat-tab>
                              <ng-template mat-tab-label>
                                <span [ngClass]="'m-r-10 d-flex align-items-center'">
                                  {{translatedLangText.SCHEDULING}}
                                </span>
                              </ng-template>
                              <div class="responsive_table">
                                <table mat-table [dataSource]="schedulingSotList" matSort
                                  class="mat-cell advance-tab-table striped-rows hover-highlight dark-header curve-table">
                                  <ng-container matColumnDef="id">
                                    <mat-header-cell *matHeaderCellDef></mat-header-cell>
                                    <mat-cell *matCellDef="let row">{{row.guid}}</mat-cell>
                                  </ng-container>
                                  <ng-container matColumnDef="book_type_cv">
                                    <mat-header-cell mat-header-cell *matHeaderCellDef
                                      [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                      {{translatedLangText.BOOKING_TYPE}}
                                    </mat-header-cell>
                                    <mat-cell mat-cell *matCellDef="let row"
                                      [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                      <span
                                        class="mobile-tab-label">{{translatedLangText.BOOKING_TYPE}}:</span>{{getBookingTypeDescription(row?.scheduling?.book_type_cv)}}
                                    </mat-cell>
                                  </ng-container>
                                  <ng-container matColumnDef="scheduling_dt">
                                    <mat-header-cell mat-header-cell *matHeaderCellDef
                                      [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                      {{translatedLangText.SCHEDULING_DATE}}
                                    </mat-header-cell>
                                    <mat-cell mat-cell *matCellDef="let row"
                                      [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                      <span class="mobile-tab-label">{{translatedLangText.SCHEDULING_DATE}}:</span>
                                      <span>{{displayDate(row?.scheduling_dt) ?? "-"}}</span>
                                    </mat-cell>
                                  </ng-container>
                                  <ng-container matColumnDef="reference">
                                    <mat-header-cell mat-header-cell *matHeaderCellDef
                                      [ngClass]="'tbl-col-width-per-6-xl tbl-col-width-per-6-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                      {{translatedLangText.REFERENCE}}
                                    </mat-header-cell>
                                    <mat-cell mat-cell *matCellDef="let row"
                                      [ngClass]="'tbl-col-width-per-6-xl tbl-col-width-per-6-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                      <span class="mobile-tab-label">{{translatedLangText.REFERENCE}}:</span>
                                      <span>{{row?.reference || "-"}}</span>
                                    </mat-cell>
                                  </ng-container>
                                  <ng-container matColumnDef="status_cv">
                                    <mat-header-cell mat-header-cell *matHeaderCellDef
                                      [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                      {{translatedLangText.STATUS}}
                                    </mat-header-cell>
                                    <mat-cell mat-cell *matCellDef="let row"
                                      [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                      <span
                                        class="mobile-tab-label">{{translatedLangText.STATUS}}:</span>{{getBookingStatusDescription(row?.status_cv)}}
                                    </mat-cell>
                                  </ng-container>
                                  <mat-header-row *matHeaderRowDef="displayedColumnsScheduling"></mat-header-row>
                                  <mat-row *matRowDef="let row; columns: displayedColumnsScheduling;"
                                    [style.cursor]="'pointer'" matRipple>
                                  </mat-row>
                                </table>
                              </div>
                              <!-- No result -->
                              @if (!(schedulingSotDS.loading$ | async) && !schedulingSotList.length) {
                              <div class="no-results">
                                <mat-divider></mat-divider>
                                <div class="no-results m-l-20 pt-3">
                                  <h5 class="m-b-15">{{translatedLangText.NO_RESULT}}</h5>
                                </div>
                              </div>
                              }
                              <!-- Loading spinner -->
                              @if (schedulingSotDS.loading$ | async) {
                              <div class="tbl-spinner">
                                <mat-progress-spinner color="primary" [diameter]="40" mode="indeterminate">
                                </mat-progress-spinner>
                              </div>
                              }
                            </mat-tab>
                            }
                            }
                          </mat-tab-group>
                          }
                          @else {
                          @for (tab of allowedTabs; track tab.label) {
                          @if (tab.component == 'booking') {
                          <div class="responsive_table">
                            <table mat-table [dataSource]="bookingList" matSort
                              class="mat-cell advance-tab-table striped-rows hover-highlight dark-header curve-table">
                              <ng-container matColumnDef="id">
                                <mat-header-cell *matHeaderCellDef></mat-header-cell>
                                <mat-cell *matCellDef="let row">{{row.guid}}</mat-cell>
                              </ng-container>
                              <ng-container matColumnDef="book_type_cv">
                                <mat-header-cell mat-header-cell *matHeaderCellDef
                                  [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                  {{translatedLangText.BOOKING_TYPE}}
                                </mat-header-cell>
                                <mat-cell mat-cell *matCellDef="let row"
                                  [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                  <span
                                    class="mobile-tab-label">{{translatedLangText.BOOKING_TYPE}}:</span>{{getBookingTypeDescription(row.book_type_cv)}}
                                </mat-cell>
                              </ng-container>
                              <ng-container matColumnDef="booking_dt">
                                <mat-header-cell mat-header-cell *matHeaderCellDef
                                  [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                  {{translatedLangText.BOOKING_DATE}}
                                </mat-header-cell>
                                <mat-cell mat-cell *matCellDef="let row"
                                  [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                  <span class="mobile-tab-label">{{translatedLangText.BOOKING_DATE}}:</span>
                                  <span>{{displayDate(row.booking_dt) ?? "-"}}</span>
                                </mat-cell>
                              </ng-container>
                              <ng-container matColumnDef="reference">
                                <mat-header-cell mat-header-cell *matHeaderCellDef
                                  [ngClass]="'tbl-col-width-per-4-xl tbl-col-width-per-4-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                  {{translatedLangText.REFERENCE}}
                                </mat-header-cell>
                                <mat-cell mat-cell *matCellDef="let row"
                                  [ngClass]="'tbl-col-width-per-4-xl tbl-col-width-per-4-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                  <span class="mobile-tab-label">{{translatedLangText.REFERENCE}}:</span>
                                  <span>{{row.reference ?? "-"}}</span>
                                </mat-cell>
                              </ng-container>
                              <ng-container matColumnDef="surveyor">
                                <mat-header-cell mat-header-cell *matHeaderCellDef
                                  [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                  {{translatedLangText.SURVEYOR}}
                                </mat-header-cell>
                                <mat-cell mat-cell *matCellDef="let row"
                                  [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                  <span class="mobile-tab-label">{{translatedLangText.SURVEYOR}}:</span>
                                  <span>{{row.test_class_cv ?? "-"}}</span>
                                </mat-cell>
                              </ng-container>
                              <ng-container matColumnDef="status_cv">
                                <mat-header-cell mat-header-cell *matHeaderCellDef
                                  [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                  {{translatedLangText.STATUS}}
                                </mat-header-cell>
                                <mat-cell mat-cell *matCellDef="let row"
                                  [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                  <span
                                    class="mobile-tab-label">{{translatedLangText.STATUS}}:</span>{{getBookingStatusDescription(row?.status_cv)}}
                                </mat-cell>
                              </ng-container>
                              <mat-header-row *matHeaderRowDef="displayedColumnsBooking"></mat-header-row>
                              <mat-row *matRowDef="let row; columns: displayedColumnsBooking;"
                                [style.cursor]="'pointer'" matRipple>
                              </mat-row>
                            </table>
                          </div>
                          <!-- No result -->
                          @if (!(bkDS.loading$ | async) && !bookingList.length) {
                          <div class="no-results">
                            <mat-divider></mat-divider>
                            <div class="no-results m-l-20 pt-3">
                              <h5 class="m-b-15">{{translatedLangText.NO_RESULT}}</h5>
                            </div>
                          </div>
                          }
                          <!-- Loading spinner -->
                          @if (bkDS.loading$ | async) {
                          <div class="tbl-spinner">
                            <mat-progress-spinner color="primary" [diameter]="40" mode="indeterminate">
                            </mat-progress-spinner>
                          </div>
                          }
                          }

                          @if (tab.component == 'scheduling') {
                          <div class="responsive_table">
                            <table mat-table [dataSource]="schedulingSotList" matSort
                              class="mat-cell advance-tab-table striped-rows hover-highlight dark-header curve-table">
                              <ng-container matColumnDef="id">
                                <mat-header-cell *matHeaderCellDef></mat-header-cell>
                                <mat-cell *matCellDef="let row">{{row.guid}}</mat-cell>
                              </ng-container>
                              <ng-container matColumnDef="book_type_cv">
                                <mat-header-cell mat-header-cell *matHeaderCellDef
                                  [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                  {{translatedLangText.BOOKING_TYPE}}
                                </mat-header-cell>
                                <mat-cell mat-cell *matCellDef="let row"
                                  [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                  <span
                                    class="mobile-tab-label">{{translatedLangText.BOOKING_TYPE}}:</span>{{getBookingTypeDescription(row?.scheduling?.book_type_cv)}}
                                </mat-cell>
                              </ng-container>
                              <ng-container matColumnDef="scheduling_dt">
                                <mat-header-cell mat-header-cell *matHeaderCellDef
                                  [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                  {{translatedLangText.SCHEDULING_DATE}}
                                </mat-header-cell>
                                <mat-cell mat-cell *matCellDef="let row"
                                  [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                  <span class="mobile-tab-label">{{translatedLangText.SCHEDULING_DATE}}:</span>
                                  <span>{{displayDate(row?.scheduling_dt) ?? "-"}}</span>
                                </mat-cell>
                              </ng-container>
                              <ng-container matColumnDef="reference">
                                <mat-header-cell mat-header-cell *matHeaderCellDef
                                  [ngClass]="'tbl-col-width-per-6-xl tbl-col-width-per-6-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                  {{translatedLangText.REFERENCE}}
                                </mat-header-cell>
                                <mat-cell mat-cell *matCellDef="let row"
                                  [ngClass]="'tbl-col-width-per-6-xl tbl-col-width-per-6-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                  <span class="mobile-tab-label">{{translatedLangText.REFERENCE}}:</span>
                                  <span>{{row?.reference || "-"}}</span>
                                </mat-cell>
                              </ng-container>
                              <ng-container matColumnDef="status_cv">
                                <mat-header-cell mat-header-cell *matHeaderCellDef
                                  [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                  {{translatedLangText.STATUS}}
                                </mat-header-cell>
                                <mat-cell mat-cell *matCellDef="let row"
                                  [ngClass]="'tbl-col-width-per-2-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm'">
                                  <span
                                    class="mobile-tab-label">{{translatedLangText.STATUS}}:</span>{{getBookingStatusDescription(row?.status_cv)}}
                                </mat-cell>
                              </ng-container>
                              <mat-header-row *matHeaderRowDef="displayedColumnsScheduling"></mat-header-row>
                              <mat-row *matRowDef="let row; columns: displayedColumnsScheduling;"
                                [style.cursor]="'pointer'" matRipple>
                              </mat-row>
                            </table>
                          </div>
                          <!-- No result -->
                          @if (!(schedulingSotDS.loading$ | async) && !schedulingSotList.length) {
                          <div class="no-results">
                            <mat-divider></mat-divider>
                            <div class="no-results m-l-20 pt-3">
                              <h5 class="m-b-15">{{translatedLangText.NO_RESULT}}</h5>
                            </div>
                          </div>
                          }
                          <!-- Loading spinner -->
                          @if (schedulingSotDS.loading$ | async) {
                          <div class="tbl-spinner">
                            <mat-progress-spinner color="primary" [diameter]="40" mode="indeterminate">
                            </mat-progress-spinner>
                          </div>
                          }
                          }
                          }
                          }
                        </div>
                      </div>
                    </mat-card-content>
                    }
                  </div>
                </mat-expansion-panel>
                <mat-expansion-panel [expanded]="verifySection(accordionSections.survey_details)">
                  <mat-expansion-panel-header class="ps-0 tank-header"
                    (click)="setSection(accordionSections.survey_details)">
                    <mat-panel-title>
                      <div class="d-flex justify-content-between align-items-center w-100">
                        <div class="header">
                          <h2>
                            {{translatedLangText.EXTERNAL_SURVEY_DETAILS}}
                          </h2>
                        </div>
                        <button mat-icon-button (click)="expandAll($event, accordionSections.survey_details)"
                          [matTooltip]="!isAllExpand() ? translatedLangText.EXPAND_ALL : translatedLangText.COLLAPSE_ALL">
                          <mat-icon>unfold_more</mat-icon>
                        </button>
                      </div>
                    </mat-panel-title>
                  </mat-expansion-panel-header>
                  <div class="body p-l-0 p-r-0">
                    @if ((surveyDS.loading$ | async)) {
                    <div class="tbl-spinner">
                      <mat-progress-spinner color="primary" [diameter]="40" mode="indeterminate">
                      </mat-progress-spinner>
                    </div>
                    }
                    @if (!(surveyDS.loading$ | async)) {
                    <mat-card-content>
                      <div class="row">
                        <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-xs-12 m-b-0">
                          <div class="responsive_table">
                            <table mat-table [dataSource]="surveyList" matSort
                              class="mat-cell advance-tab-table striped-rows hover-highlight dark-header curve-table">
                              <ng-container matColumnDef="id">
                                <mat-header-cell *matHeaderCellDef></mat-header-cell>
                                <mat-cell *matCellDef="let row">{{row.guid}}</mat-cell>
                              </ng-container>
                              <ng-container matColumnDef="survey_type">
                                <mat-header-cell mat-header-cell *matHeaderCellDef [ngClass]="''">
                                  {{translatedLangText.SURVEY_TYPE}}
                                </mat-header-cell>
                                <mat-cell mat-cell *matCellDef="let row" [ngClass]="''">
                                  <span
                                    class="mobile-tab-label">{{translatedLangText.SURVEY_TYPE}}:</span>{{getSurveyTypeDescription(row.survey_type_cv)}}
                                </mat-cell>
                              </ng-container>
                              <ng-container matColumnDef="survey_dt">
                                <mat-header-cell mat-header-cell *matHeaderCellDef [ngClass]="''">
                                  {{translatedLangText.SURVEY_DATE}}
                                </mat-header-cell>
                                <mat-cell mat-cell *matCellDef="let row" [ngClass]="''">
                                  <span class="mobile-tab-label">{{translatedLangText.SURVEY_DATE}}:</span>
                                  <span>{{displayDate(row?.survey_dt) ?? "-"}}</span>
                                </mat-cell>
                              </ng-container>
                              <ng-container matColumnDef="surveyor">
                                <mat-header-cell mat-header-cell *matHeaderCellDef [ngClass]="''">
                                  {{translatedLangText.SURVEYOR}}
                                </mat-header-cell>
                                <mat-cell mat-cell *matCellDef="let row" [ngClass]="''">
                                  <span
                                    class="mobile-tab-label">{{translatedLangText.SURVEYOR}}:</span>{{row.test_class_cv}}
                                </mat-cell>
                              </ng-container>
                              <ng-container matColumnDef="status_cv">
                                <mat-header-cell mat-header-cell *matHeaderCellDef
                                  [ngClass]="'tbl-col-width-per-3-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm justify-content-center'">
                                  {{translatedLangText.STATUS}}
                                </mat-header-cell>
                                <mat-cell mat-cell *matCellDef="let row"
                                  [ngClass]="'tbl-col-width-per-3-xl tbl-col-width-per-2-lg tbl-col-width-per-12-md tbl-col-width-per-12-sm justify-content-center'">
                                  <span class="mobile-tab-label">{{translatedLangText.STATUS}}:</span>
                                  @if (row?.status_cv === "ACCEPTED") {
                                  <mat-icon [ngClass]="'font-bold text-success'">
                                    checked
                                  </mat-icon>
                                  }
                                  @else {
                                  <mat-icon>
                                    close
                                  </mat-icon>
                                  }
                                </mat-cell>
                              </ng-container>
                              <ng-container matColumnDef="remarks">
                                <mat-header-cell mat-header-cell *matHeaderCellDef [ngClass]="''">
                                  {{translatedLangText.REFERENCE}}
                                </mat-header-cell>
                                <mat-cell mat-cell *matCellDef="let row" [ngClass]="''">
                                  <span class="mobile-tab-label">{{translatedLangText.REFERENCE}}:</span>
                                  <span>{{row.remarks ?? "-"}}</span>
                                </mat-cell>
                              </ng-container>
                              <ng-container matColumnDef="update_by">
                                <mat-header-cell mat-header-cell *matHeaderCellDef [ngClass]="''">
                                  {{translatedLangText.UPDATE_BY}}
                                </mat-header-cell>
                                <mat-cell mat-cell *matCellDef="let row" [ngClass]="''">
                                  <span class="mobile-tab-label">{{translatedLangText.UPDATE_BY}}:</span>
                                  <span>{{row.update_by || row.create_by || "-"}}</span>
                                </mat-cell>
                              </ng-container>
                              <mat-header-row *matHeaderRowDef="displayedColumnsSurveyDetail"></mat-header-row>
                              <mat-row *matRowDef="let row; columns: displayedColumnsSurveyDetail;"
                                [style.cursor]="'pointer'" matRipple>
                              </mat-row>
                            </table>
                          </div>
                          <!-- No result -->
                          @if (!(surveyDS.loading$ | async) && !surveyList.length) {
                          <div class="no-results">
                            <mat-divider></mat-divider>
                            <div class="no-results m-l-20 pt-3">
                              <h5 class="m-b-15">{{translatedLangText.NO_RESULT}}</h5>
                            </div>
                          </div>
                          }
                          <!-- Loading spinner -->
                          @if (surveyDS.loading$ | async) {
                          <div class="tbl-spinner">
                            <mat-progress-spinner color="primary" [diameter]="40" mode="indeterminate">
                            </mat-progress-spinner>
                          </div>
                          }
                        </div>
                      </div>
                    </mat-card-content>
                    }
                  </div>
                </mat-expansion-panel>
                @if(allowPerformAction()){
                <mat-expansion-panel class="alternate-panel"
                  [expanded]="verifySection(accordionSections.transfer_details)">
                  <mat-expansion-panel-header class="ps-0 tank-header"
                    (click)="setSection(accordionSections.transfer_details)">
                    <mat-panel-title>
                      <div class="d-flex justify-content-between align-items-center w-100">
                        <div class="header">
                          <h2>
                            {{translatedLangText.RELOCATION_DETAILS}}
                          </h2>
                        </div>
                        <button mat-icon-button (click)="expandAll($event, accordionSections.transfer_details)"
                          [matTooltip]="!isAllExpand() ? translatedLangText.EXPAND_ALL : translatedLangText.COLLAPSE_ALL">
                          <mat-icon>unfold_more</mat-icon>
                        </button>
                      </div>
                    </mat-panel-title>
                  </mat-expansion-panel-header>
                  <div class="body p-l-0 p-r-0">
                    @if ((transferDS.loading$ | async)) {
                    <div class="tbl-spinner">
                      <mat-progress-spinner color="primary" [diameter]="40" mode="indeterminate">
                      </mat-progress-spinner>
                    </div>
                    }
                    @if (!(transferDS.loading$ | async)) {
                    <mat-card-content>
                      <div class="row">
                        <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-xs-12 m-b-0">
                          <div class="responsive_table">
                            <table mat-table [dataSource]="transferList" matSort
                              class="mat-cell advance-tab-table striped-rows hover-highlight dark-header curve-table">
                              <ng-container matColumnDef="id">
                                <mat-header-cell *matHeaderCellDef></mat-header-cell>
                                <mat-cell *matCellDef="let row">{{row.guid}}</mat-cell>
                              </ng-container>
                              <ng-container matColumnDef="transfer_out_dt">
                                <mat-header-cell mat-header-cell *matHeaderCellDef [ngClass]="''">
                                  {{translatedLangText.FROM}}
                                </mat-header-cell>
                                <mat-cell mat-cell *matCellDef="let row" [ngClass]="''">
                                  <span
                                    class="mobile-tab-label">{{translatedLangText.FROM}}:</span>{{displayDate(row.transfer_out_dt)}}
                                </mat-cell>
                              </ng-container>
                              <ng-container matColumnDef="transfer_in_dt">
                                <mat-header-cell mat-header-cell *matHeaderCellDef [ngClass]="''">
                                  {{translatedLangText.TO}}
                                </mat-header-cell>
                                <mat-cell mat-cell *matCellDef="let row" [ngClass]="''">
                                  <span class="mobile-tab-label">{{translatedLangText.TO}}:</span>
                                  <span>{{displayDate(row.transfer_in_dt) ?? "-"}}</span>
                                </mat-cell>
                              </ng-container>
                              <ng-container matColumnDef="days">
                                <mat-header-cell mat-header-cell *matHeaderCellDef [ngClass]="''">
                                  {{translatedLangText.DAYS}}
                                </mat-header-cell>
                                <mat-cell mat-cell *matCellDef="let row" [ngClass]="''">
                                  <span class="mobile-tab-label">{{translatedLangText.DAYS}}:</span>
                                  <span>{{transferDS.getDays(row) || "-"}}</span>
                                </mat-cell>
                              </ng-container>
                              <ng-container matColumnDef="location_from_cv">
                                <mat-header-cell mat-header-cell *matHeaderCellDef [ngClass]="''">
                                  {{translatedLangText.FROM_YARD}}
                                </mat-header-cell>
                                <mat-cell mat-cell *matCellDef="let row" [ngClass]="''">
                                  <span
                                    class="mobile-tab-label">{{translatedLangText.FROM_YARD}}:</span>{{getYardDescription(row?.location_from_cv)}}
                                </mat-cell>
                              </ng-container>
                              <ng-container matColumnDef="location_to_cv">
                                <mat-header-cell mat-header-cell *matHeaderCellDef [ngClass]="''">
                                  {{translatedLangText.TO_YARD}}
                                </mat-header-cell>
                                <mat-cell mat-cell *matCellDef="let row" [ngClass]="''">
                                  <span
                                    class="mobile-tab-label">{{translatedLangText.TO_YARD}}:</span>{{getYardDescription(row?.location_to_cv)}}
                                </mat-cell>m
                              </ng-container>
                              <ng-container matColumnDef="update_by">
                                <mat-header-cell mat-header-cell *matHeaderCellDef [ngClass]="''">
                                  {{translatedLangText.UPDATE_BY}}
                                </mat-header-cell>
                                <mat-cell mat-cell *matCellDef="let row" [ngClass]="''">
                                  <span
                                    class="mobile-tab-label">{{translatedLangText.UPDATE_BY}}:</span>{{row?.update_by}}
                                </mat-cell>
                              </ng-container>
                              <ng-container matColumnDef="update_dt">
                                <mat-header-cell mat-header-cell *matHeaderCellDef [ngClass]="''">
                                  {{translatedLangText.UPDATE_DATE}}
                                </mat-header-cell>
                                <mat-cell mat-cell *matCellDef="let row" [ngClass]="''">
                                  <span
                                    class="mobile-tab-label">{{translatedLangText.UPDATE_DATE}}:</span>{{displayDateTime(row?.update_dt
                                  || row?.create_dt)}}
                                </mat-cell>
                              </ng-container>
                              <mat-header-row *matHeaderRowDef="displayedColumnsTransfer"></mat-header-row>
                              <mat-row *matRowDef="let row; columns: displayedColumnsTransfer;"
                                [style.cursor]="'pointer'" matRipple>
                              </mat-row>
                            </table>
                          </div>
                          <!-- No result -->
                          @if (!(transferDS.loading$ | async) && !transferList.length) {
                          <div class="no-results">
                            <mat-divider></mat-divider>
                            <div class="no-results m-l-20 pt-3">
                              <h5 class="m-b-15">{{translatedLangText.NO_RESULT}}</h5>
                            </div>
                          </div>
                          }
                          <!-- Loading spinner -->
                          @if (transferDS.loading$ | async) {
                          <div class="tbl-spinner">
                            <mat-progress-spinner color="primary" [diameter]="40" mode="indeterminate">
                            </mat-progress-spinner>
                          </div>
                          }
                        </div>
                      </div>
                    </mat-card-content>
                    }
                  </div>
                </mat-expansion-panel>
                }
                <!-- <mat-expansion-panel [expanded]="section === 'tank_overview'" (click)="setSection('tank_overview')">
                  <mat-expansion-panel-header class="ps-0">
                    <mat-panel-title>
                      <div class="header">
                        <h2>
                          {{translatedLangText.TANK_OVERVIEW}}
                        </h2>
                      </div>
                    </mat-panel-title>
                  </mat-expansion-panel-header>
                  <div class="body p-l-0 p-r-0">
                    @if ((bkDS.loading$ | async) || (schedulingDS.loading$ | async)) {
                    <div class="tbl-spinner">
                      <mat-progress-spinner color="primary" [diameter]="40" mode="indeterminate">
                      </mat-progress-spinner>
                    </div>
                    }
                    @if (!(bkDS.loading$ | async) && !(schedulingDS.loading$ | async)) {
                    <mat-card-content>
                      <div class="row">
                        <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-xs-12 m-b-0">
                          <mat-stepper class="example-stepper" labelPosition="bottom" [orientation]="(stepperOrientation | async)!">
                            <mat-step>
                              <ng-template matStepLabel>SO Generated</ng-template>
                            </mat-step>
                            <mat-step>
                              <ng-template matStepLabel>In Gate</ng-template>
                            </mat-step>
                            <mat-step>
                              <ng-template matStepLabel>In Gate Survey</ng-template>
                            </mat-step>
                            <mat-step>
                              <ng-template matStepLabel>Steam</ng-template>
                            </mat-step>
                            <mat-step>
                              <ng-template matStepLabel>Residue</ng-template>
                            </mat-step>
                            <mat-step>
                              <ng-template matStepLabel>Cleaning</ng-template>
                            </mat-step>
                            <mat-step>
                              <ng-template matStepLabel>Repair</ng-template>
                            </mat-step>
                            <mat-step>
                              <ng-template matStepLabel>Storage</ng-template>
                            </mat-step>
                            <mat-step>
                              <ng-template matStepLabel>Out Gate</ng-template>
                            </mat-step>
                            <mat-step>
                              <ng-template matStepLabel>Out Gate Survey</ng-template>
                            </mat-step>
                            <mat-step>
                              <ng-template matStepLabel>RO Generated</ng-template>
                            </mat-step>
                          </mat-stepper>
                          @if (schedulingDS.loading$ | async) {
                          <div class="tbl-spinner">
                            <mat-progress-spinner color="primary" [diameter]="40" mode="indeterminate">
                            </mat-progress-spinner>
                          </div>
                          }
                        </div>
                      </div>
                    </mat-card-content>
                    }
                  </div>
                </mat-expansion-panel> -->
              </mat-accordion>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>