<section class="content">
  <div class="content-block">
    <div class="block-header">
      <!-- breadcrumb -->
      <app-breadcrumb [title]="pageTitle" [items]="breadcrumsMiddleList" [active_item]="NEW"></app-breadcrumb>
    </div>
    <div class="row clearfix">
      <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12">
        <div class="card">
          <div class="header">
            <h2>{{PROCEDURE_DETAILS | translate}}</h2>
          </div>
          <div class="body">
            <form class="ms-0" [formGroup]="thirdForm!" (ngSubmit)="onThirdFormSubmit()">
              <div class="row">
                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-1">
                  <mat-form-field class="example-full-width">
                    <mat-label>{{PROCEDURE_NAME | translate}}</mat-label>
                    <input matInput formControlName="procedure_name" required>
                    @if (thirdForm?.get('procedure_name')?.hasError('required')) {
                    <mat-error>
                      {{PROCEDURE_NAME | translate}} {{PROCEDURE_REQUIRED | translate}}
                    </mat-error>
                    }
                  </mat-form-field>
                </div>
              </div>
              <div class="row">
                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-1">
                  <mat-form-field class="example-full-width">
                    <mat-label>{{PROCEDURE_DESCRIPTION | translate}}</mat-label>
                    <input matInput formControlName="description" required>
                    @if (thirdForm?.get('description')?.hasError('required')) {
                    <mat-error>
                      {{PROCEDURE_DESCRIPTION | translate}} {{PROCEDURE_REQUIRED | translate}}
                    </mat-error>
                    }
                  </mat-form-field>
                </div>
              </div>
              <div class="row">
                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-1">
                  <mat-form-field class="example-full-width">
                    <mat-label>{{PROCEDURE_CLEAN_CATEGORY | translate}}</mat-label>
                    <mat-select formControlName="clean_category" required>
                      <mat-option [value]="'Easy'">
                        Easy
                      </mat-option>
                      <mat-option [value]="'Standard'">
                        Standard
                      </mat-option>
                      <mat-option [value]="'Difficult'">
                        Difficult
                      </mat-option>
                      <mat-option [value]="'Special'">
                        Special
                      </mat-option>
                    </mat-select>
                    @if (thirdForm?.get('clean_category')?.hasError('required')) {
                    <mat-error>
                      {{PROCEDURE_CLEAN_CATEGORY | translate}} {{PROCEDURE_REQUIRED | translate}}
                    </mat-error>
                    }
                  </mat-form-field>
                </div>
              </div>
              <div class="row">
                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-1">
                  <mat-form-field class="example-full-width">
                    <mat-label>{{PROCEDURE_CLEAN_GROUP | translate}}</mat-label>
                    <input type="text" matInput [formControl]="myControl2" [matAutocomplete]="autoGroups">
                    <mat-autocomplete #autoGroups="matAutocomplete" [displayWith]="displayCleanGroupFn" (optionSelected)="onSelectCleanGroup($event)">
                      @for (group of filteredCleanGroupOptions | async; track group) {
                      <mat-option [value]="group">
                        {{group.groupName}}
                      </mat-option>
                      }
                    </mat-autocomplete>
                    @if (thirdForm?.get('clean_group')?.hasError('required')) {
                    <mat-error>
                      {{PROCEDURE_CLEAN_GROUP | translate}} {{PROCEDURE_REQUIRED | translate}}
                    </mat-error>
                    }
                  </mat-form-field>
                </div>
              </div>
              <div class="row">
                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 mb-1">
                  <mat-form-field class="example-full-width">
                    <mat-label>{{PROCEDURE_MIN_COST | translate}}</mat-label>
                    <input matInput [value]="selectedGroup?.minCost| number:'1.2-2'" readonly>
                    <mat-icon class="material-icons-two-tone color-icon p-0" matPrefix>attach_money</mat-icon>
                  </mat-form-field>
                </div>
                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 mb-1">
                  <mat-form-field class="example-full-width">
                    <mat-label>{{PROCEDURE_MAX_COST | translate}}</mat-label>
                    <input matInput [value]="selectedGroup?.maxCost | number:'1.2-2'" readonly>
                    <mat-icon class="material-icons-two-tone color-icon p-0" matPrefix>attach_money</mat-icon>
                  </mat-form-field>
                </div>
              </div>
              <div class="row">
                <div class="row">
                  <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 mb-1">
                    <mat-form-field class="example-full-width">
                      <mat-label>{{PROCEDURE_TOTAL_DURATION | translate}}</mat-label>
                      <input matInput [value]="totalDuration$ | async" readonly>
                      <mat-icon class="material-icons-two-tone color-icon p-3" matSuffix>access_time</mat-icon>
                    </mat-form-field>
                  </div>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
      <div class="col-xl-8 col-lg-8 col-md-12 col-sm-12">
        <div class="card">
          <div class="header d-flex">
            <h2>{{PROCEDURE_STEPS | translate}}</h2>
          </div>
          <div class="body">
            <div class="materialTableHeader">
              <div class="left">
                <!-- <div class="row header-buttons-left">
                  <div class="col-xl-2 col-lg-5 col-md-4 col-sm-4 m-b-0 p-l-1 p-r-0">
                    <div class="tbl-title">
                      <h2>{{PROCEDURE_STEP_NAME | translate}}</h2>
                    </div>
                  </div>
                  <div class="col-xl-3 col-lg-7 col-md-6 col-sm-6 m-b-0 p-l-1 p-r-0">
                    <div class="tbl-search-box m-l-0">
                      <input type="text" matInput [formControl]="myControl" [matAutocomplete]="auto"
                        class="browser-default search-field unset-width ps-2">
                      <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayCleanStepFn" (optionSelected)="onSelectCleanStep($event)">
                        @for (option of filteredCleanStepOptions | async; track option) {
                        <mat-option [value]="option">
                          {{option.stepName}}
                        </mat-option>
                        }
                      </mat-autocomplete>
                    </div>
                  </div>
                  <div class="col-xl-2 col-lg-5 col-md-4 col-sm-4 m-b-0 p-l-1 p-r-0">
                    <div class="tbl-title m-l-0">
                      <h2>{{PROCEDURE_STEP_DURATION | translate}}</h2>
                    </div>
                  </div>
                  <div class="col-xl-3 col-lg-7 col-md-6 col-sm-6 m-b-0 p-l-1 p-r-0">
                    <div class="tbl-search-box">
                      <input matInput type="number" [(ngModel)]="cleanStepDuration" class="browser-default search-field unset-width ps-2">
                    </div>
                  </div>
                  <div class="col-xl col-lg col-md col-sm m-b-0 p-r-0">
                    <div class="m-l-40" matTooltip="ADD">
                      <button mat-mini-fab color="primary" (click)="addCleanStep()">
                        <mat-icon class="col-white">add</mat-icon>
                      </button>
                    </div>
                  </div>
                </div> -->
                <ul class="header-buttons-left ms-0">
                  <li class="tbl-title">
                    <h2>{{PROCEDURE_STEP_NAME | translate}}</h2>
                  </li>
                  <li class="tbl-search-box">
                    <input type="text" matInput [formControl]="myControl" [matAutocomplete]="auto"
                      class="browser-default search-field ps-2">
                    <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayCleanStepFn" (optionSelected)="onSelectCleanStep($event)">
                      @for (option of filteredCleanStepOptions | async; track option) {
                      <mat-option [value]="option">
                        {{option.stepName}}
                      </mat-option>
                      }
                    </mat-autocomplete>
                  </li>
                  <li class="tbl-title">
                    <h2>{{PROCEDURE_STEP_DURATION | translate}}</h2>
                  </li>
                  <li class="tbl-search-box">
                    <input matInput type="number" [(ngModel)]="cleanStepDuration" class="browser-default search-field ps-2">
                  </li>
                  <li class="tbl-header-btn">
                    <div class="m-l-10" matTooltip="ADD">
                      <button mat-mini-fab color="primary" (click)="addCleanStep()">
                        <mat-icon class="col-white">add</mat-icon>
                      </button>
                    </div>
                  </li>
                </ul>
              </div>
              <div class="right">
                <ul class="tbl-export-btn">
                  <li class="tbl-header-btn">
                    <div class="m-l-10" matTooltip="DELETE" (click)="deleteCleanStep()">
                      <button mat-mini-fab color="warn">
                        <mat-icon class="col-white">delete
                        </mat-icon>
                      </button>
                    </div>
                  </li>
                </ul>
              </div>
            </div>
            <div class="task-module">
              <div class="row">
                <div class="col-md-12 col-sm-12">
                  <mat-sidenav-container class="task-container">
                    <mat-sidenav #sidenav [mode]="mode.value" position="end">
                      <div class="header">
                        <h2 class="header-title">{{dialogTitle}}</h2>
                        <div class="header-close m-r-0">
                          @if (!isNewEvent) {
                          <button mat-icon-button (click)="deleteTask(sidenav)" matTooltip="Delete Task">
                            <mat-icon>delete</mat-icon>
                          </button>
                          }
                          @if (isNewEvent) {
                          <button mat-icon-button (click)="saveTask()" matTooltip="Save Task">
                            <mat-icon>save</mat-icon>
                          </button>
                          }
                          @if (!isNewEvent) {
                          <button mat-icon-button (click)="editTask()" matTooltip="Edit Task">
                            <mat-icon>save</mat-icon>
                          </button>
                          }
                          <button mat-icon-button (click)="closeSlider(sidenav)">
                            <mat-icon>close</mat-icon>
                          </button>
                        </div>
                      </div>
                      <form class="register-form m-4" [formGroup]="taskForm">
                        <div class="row">
                          <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 ">
                            <mat-form-field [hidden]="true">
                              <input matInput formControlName="id">
                            </mat-form-field>
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 ">
                            <mat-form-field [hidden]="true">
                              <input matInput formControlName="img">
                            </mat-form-field>
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 ">
                            <mat-form-field class="example-full-width" appearance="outline">
                              <mat-label>Title</mat-label>
                              <input matInput formControlName="title">
                              <mat-icon class="material-icons-two-tone color-icon p-3" matSuffix>turned_in_not
                              </mat-icon>
                            </mat-form-field>
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-3">
                            <mat-checkbox class="example-margin" formControlName="done" color="primary">Mark as
                              complete
                            </mat-checkbox>
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-3">
                            <mat-form-field class="example-full-width" appearance="outline">
                              <mat-label>Assigned Name</mat-label>
                              <mat-select formControlName="name">
                                <mat-option [value]="'Sarah Smith'">
                                  Sarah Smith
                                </mat-option>
                                <mat-option [value]="'John Deo'">
                                  John Deo
                                </mat-option>
                                <mat-option [value]="'Jens Brincker'">
                                  Jens Brincker
                                </mat-option>
                                <mat-option [value]="'Mark Hay'">
                                  Mark Hay
                                </mat-option>
                                <mat-option [value]="'Anthony Davie'">
                                  Anthony Davie
                                </mat-option>
                                <mat-option [value]="'Sue Woodger'">
                                  Sue Woodger
                                </mat-option>
                              </mat-select>
                            </mat-form-field>
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12 mb-2">
                            <mat-form-field class="example-full-width" appearance="outline">
                              <mat-label>Priority</mat-label>
                              <mat-select formControlName="priority">
                                <mat-option [value]="'Low'">
                                  Low
                                </mat-option>
                                <mat-option [value]="'Normal'">
                                  Normal
                                </mat-option>
                                <mat-option [value]="'High'">
                                  High
                                </mat-option>
                              </mat-select>
                            </mat-form-field>
                          </div>
                          <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12 mb-2">
                            <mat-form-field class="example-full-width" appearance="outline">
                              <mat-label>Due date</mat-label>
                              <input matInput formControlName="due_date" [matDatepicker]="picker1">
                              <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                              <mat-datepicker #picker1></mat-datepicker>
                            </mat-form-field>
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
                            <mat-form-field class="example-full-width" appearance="outline">
                              <mat-label>Event Details</mat-label>
                              <textarea matInput formControlName="note"></textarea>
                            </mat-form-field>
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-xl-10 col-lg-10 col-md-12 col-sm-12">
                          </div>
                        </div>
                      </form>
                    </mat-sidenav>
                    <mat-sidenav-content>
                      <ng-scrollbar style="height: 500px" visibility="hover">
                        <div cdkDropList class="task-list" (cdkDropListDropped)="drop($event)">
                          @for (step of (cleanSteps$ | async); track step) {
                          <div class="task-box" (click)="taskClick(step, sidenav)" cdkDrag>
                            <div>
                              <div class="task-handle m-r-10" cdkDragHandle>
                                <mat-icon aria-hidden="false">drag_indicator</mat-icon>
                              </div>
                            </div>
                            <mat-checkbox (change)="toggle(step, sidenav)" [checked]="!!step.selected" class="m-r-15"
                              color="primary">
                            </mat-checkbox>
                            <div class="task-custom-placeholder" *cdkDragPlaceholder></div>
                            <div class="m-r-10" [matTooltip]="PROCEDURE_STEP_NAME | translate">
                              {{step.stepName}} -
                            </div>
                            <div class="m-r-10" [matTooltip]="PROCEDURE_DESCRIPTION | translate">
                              {{step.description}}
                            </div>
                            <div class="task-date m-l- m-r-35" [matTooltip]="PROCEDURE_STEP_DURATION_TOOLTIP | translate">
                              {{step.duration}}
                            </div>
                            <!-- <span *cdkDragPreview class="display-inline">
                              <div [matTooltip]="PROCEDURE_DESCRIPTION | translate" [ngClass]="{done:step.selected}">
                                {{step.description}}
                              </div>
                            </span> -->
                          </div>
                          }
                        </div>
                      </ng-scrollbar>
                    </mat-sidenav-content>
                  </mat-sidenav-container>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="row clearfix">
    </div>
  </div>
</section>