<div mat-dialog-title class="ms-3 mt-3">
  <h4>{{translatedLangText.PREVIEW_PDF}} ({{estimate_no}})</h4>
</div>
<div mat-dialog-content>
  <div id="pdf-form-header" class="pdf-container pdf-header">
    <div class="header-content">
      <table>
        <tbody>
          <tr>
            <td class="td-col-2-25">
              <b>{{translatedLangText.TANK_NO}}</b>
            </td>
            <td class="td-col-4-5">
              {{steamItem?.storing_order_tank?.tank_no}}
            </td>
            <td class="td-col-2-25">
              <b>{{translatedLangText.EIR_NO}}</b>
            </td>
            <td class="td-col-3">
              {{steamItem?.storing_order_tank?.in_gate?.[0]?.eir_no}}
            </td>
          </tr>
          <tr>
            <td>
              <b>{{translatedLangText.CUSTOMER}}</b>
            </td>
            <td>
              {{steamItem?.storing_order_tank?.storing_order?.customer_company?.name}}
            </td>
            <td>
              <b>{{translatedLangText.EIR_DATE}}</b>
            </td>
            <td>
              {{displayDate(steamItem?.storing_order_tank?.in_gate?.[0]?.eir_dt)}}
            </td>
          </tr>
          <tr>
            <td>
              <b>{{translatedLangText.JOB_NO}}</b>
            </td>
            <td>
              {{steamItem?.job_no}}
            </td>
            <td>
              <b>{{translatedLangText.ESTIMATE_NO}}</b>
            </td>
            <td>
              {{steamItem?.estimate_no}}
            </td>
          </tr>
          <tr>
            <td>
              <b>{{translatedLangText.CARGO_NAME}}</b>
            </td>
            <td>
              {{steamItem?.storing_order_tank?.tariff_cleaning?.cargo}}
            </td>
            <td>
              <b>{{translatedLangText.FLASH_POINT}}</b>
            </td>
            <td class="text-danger">
              {{steamItem?.storing_order_tank?.tariff_cleaning?.flash_point}} {{translatedLangText.DEGREE_CELSIUS_SYMBOL}}
            </td>
          </tr>
          <tr>
            <td>
              <b>{{translatedLangText.ETR_DATE}}</b>
            </td>
            <td>
              {{displayDate(steamItem?.storing_order_tank?.etr_dt)}}
            </td>
            <td>
              <b>{{translatedLangText.REQUIRED_TEMP}}</b>
            </td>
            <td>
              {{steamItem?.storing_order_tank?.required_temp}} {{translatedLangText.DEGREE_CELSIUS_SYMBOL}}
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div id="pdf-form-body" class="pdf-container pdf-body">
    <div class="body-title text-decoration-underline pt-2 pb-2">
      <b>{{pdfTitle}}</b>
    </div>
    <table id="steam-temp-table" class="steam-temp-table">
      <tbody>
        <tr>
          <td class="td-col-0-5 text-center align-middle steam-temp-header" rowspan="2">
            <b>{{translatedLangText.NO_DOT}}</b>
          </td>
          <td class="td-col-2 text-center align-middle steam-temp-header" rowspan="2">
            <b>{{translatedLangText.TIME}}</b>
          </td>
          <td class="td-col-6 text-center align-middle steam-temp-header" colspan="3">
            <b>{{translatedLangText.TEMPERATURE}} {{translatedLangText.DEGREE_CELSIUS_SYMBOL}}</b>
          </td>
          <td class="td-col-3-5 text-center align-middle steam-temp-header" rowspan="2">
            <b>{{translatedLangText.REMARKS}}</b>
          </td>
        </tr>
        <tr>
          <td class="td-col-2 text-center align-middle steam-temp-subheader">
            <b>{{translatedLangText.THERMOMETER}}</b>
          </td>
          <td class="td-col-2 text-center align-middle steam-temp-subheader">
            <b>{{translatedLangText.TOP_SIDE}}</b>
          </td>
          <td class="td-col-2 text-center align-middle steam-temp-subheader">
            <b>{{translatedLangText.BOTTOM_SIDE}}</b>
          </td>
        </tr>
        @for (steamTemp of steamTempList; track steamTemp) {
        <tr>
          <td class="td-col-0-5 text-center align-middle">
            <b>{{steamTemp.index + 1}}</b>
          </td>
          <td class="td-col-2 text-center align-middle">
            {{displayDateTime(steamTemp.report_dt)}}
          </td>
          <td class="td-col-2 text-center align-middle">
            {{steamTemp.meter_temp}}
          </td>
          <td class="td-col-2 text-center align-middle">
            {{steamTemp.top_temp}}
          </td>
          <td class="td-col-2 text-center align-middle">
            {{steamTemp.bottom_temp}}
          </td>
          <td class="td-col-3-5">
            {{steamTemp.remarks}}
          </td>
        </tr>
        }
      </tbody>
    </table>
  </div>

  <div id="summary-content" class="pdf-container pdf-body summary-content">
    <table>
      <tbody>
        <tr>
          <td class="td-col-3" rowspan="3">
            <b>{{translatedLangText.APPROVED_COST}}:</b>
          </td>
          <td class="td-col-2 text-center">
            <b>{{translatedLangText.ITEM}}</b>
          </td>
          <td class="td-col-1 text-center">
            <b>{{translatedLangText.RATE_PERC}}</b>
          </td>
          <td class="td-col-3 text-center" colspan="2">
            <b>{{translatedLangText.ESTIMATE_COST}}</b>
          </td>
          <td class="td-col-3 text-center" colspan="2">
            <b>{{translatedLangText.APPROVED_COST}}</b>
          </td>
        </tr>
        <tr>
          <td class="td-col-2">
            <b>{{translatedLangText.LABOUR}}</b>
          </td>
          <td class="td-col-1 text-right">
            {{steamItem?.labour_cost}}
          </td>
          <td class="td-col-1-5 text-right">
            {{repairCost?.total_hour_table}}
          </td>
          <td class="td-col-1-5 text-right">
            {{repairCost?.total_labour_cost}}
          </td>
          <td class="td-col-1-5 text-right">

          </td>
          <td class="td-col-1-5 text-right">

          </td>
        </tr>
        <tr>
          <td class="td-col-2">
            <b>{{translatedLangText.MATERIAL}}</b>
          </td>
          <td class="td-col-1 text-right">
          </td>
          <td class="td-col-1-5 text-right">
          </td>
          <td class="td-col-1-5 text-right">
            {{repairCost?.total_mat_cost}}
          </td>
          <td class="td-col-1-5 text-right">
          </td>
          <td class="td-col-1-5 text-right">
          </td>
        </tr>
        <tr>
          <td class="td-col-3" rowspan="3">
            <b>{{translatedLangText.FOR}} {{steamItem?.storing_order_tank?.storing_order?.customer_company?.name}}</b>
          </td>
          <td class="td-col-2">
            <b>{{translatedLangText.LABOUR_DISCOUNT}}</b>
          </td>
          <td class="td-col-1 text-right">
            {{repairCost?.labour_cost_discount}}
          </td>
          <td class="td-col-1-5 text-right">
          </td>
          <td class="td-col-1-5 text-right">
            - {{repairCost?.discount_labour_cost}}
          </td>
          <td class="td-col-1-5 text-right">
          </td>
          <td class="td-col-1-5 text-right">
          </td>
        </tr>
        <tr>
          <td class="td-col-2">
            <b>{{translatedLangText.MATERIAL_DISCOUNT}}</b>
          </td>
          <td class="td-col-1 text-right">
            {{repairCost?.material_cost_discount}}
          </td>
          <td class="td-col-1-5 text-right">
          </td>
          <td class="td-col-1-5 text-right">
            - {{repairCost?.discount_mat_cost}}
          </td>
          <td class="td-col-1-5 text-right">
          </td>
          <td class="td-col-1-5 text-right">
          </td>
        </tr>
        <tr>
          <td class="td-col-2">
            <b>{{translatedLangText.NET_COST}}</b>
          </td>
          <td class="td-col-1 text-right">
          </td>
          <td class="td-col-1-5 text-right">
          </td>
          <td class="td-col-1-5 text-right">
            {{repairCost?.net_cost}}
          </td>
          <td class="td-col-1-5 text-right">
          </td>
          <td class="td-col-1-5 text-right">
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div id="pdf-form-footer" class="pdf-container pdf-footer">
    <hr class="mt-0 mb-1" />
    <div class="disclaimer">
      <span class="font-bold text-decoration-underline">{{translatedLangText.DISCLAIMER}}: </span>
      <span>{{disclaimerNote}}</span>
    </div>
    <div class="footer-info-content">
      <span>
        {{customerInfo.eirDisclaimerVer}}
      </span>
      <span>
        {{translatedLangText.PAGE}} <span id="current-page"></span> {{translatedLangText.OF}} <span
          id="total-pages"></span>
      </span>
    </div>
  </div>
</div>
<div mat-dialog-actions class="m-2 align-right">
  @if (this.existingPdf?.length) {
  <button mat-flat-button (click)="onDownloadClick()" tabindex="-1"
    [disabled]="(steamDS.actionLoading$| async) || (isFileActionLoading$| async) || (generatingPdfLoading$| async)">
    <mat-icon>
      @if (!(steamDS.actionLoading$ | async) && !(isFileActionLoading$| async) && !(generatingPdfLoading$| async)) {
      file_download
      } @else {
      <mat-spinner color="primary" [diameter]="18"></mat-spinner>
      }
    </mat-icon>
    {{translatedLangText.DOWNLOAD}}
  </button>
  }
  <button mat-flat-button color="accent" (click)="onRepublshClick()" tabindex="-1"
    [disabled]="(steamDS.actionLoading$| async) || (isFileActionLoading$| async) || (generatingPdfLoading$| async)">
    <mat-icon>
      @if (!(steamDS.actionLoading$ | async) && !(isFileActionLoading$| async) && !(generatingPdfLoading$| async)) {
      publish
      } @else {
      <mat-spinner color="primary" [diameter]="18"></mat-spinner>
      }
    </mat-icon>
    {{translatedLangText.EXPORT_NEW}}
  </button>
  @if ((generatingPdfLoading$| async)) {
  <mat-progress-bar mode="determinate" [value]="generatingPdfProgress"></mat-progress-bar>
  }
</div>